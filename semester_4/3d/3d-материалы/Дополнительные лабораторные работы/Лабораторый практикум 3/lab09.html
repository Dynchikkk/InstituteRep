<html>

<head>
<meta HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1251">
<meta NAME="GENERATOR" CONTENT="Microsoft FrontPage 3.0">
<title>Лабораторная работа №9.</title>
</head>

<body background="fon.jpg">

<hr size="1" width="100%" noshade color="gray" align="center">

<table BORDER="0" CELLPADDING="0" WIDTH="100%"
style="width:100.0%;mso-cellspacing:
 1.5pt">
  <tr>
    <td style="background:#8189BC;padding:.75pt .75pt .75pt .75pt"><p align="center"><b>Лабораторная
    работа №9.</b>&nbsp; </td>
  </tr>
</table>
<font SIZE="+2" COLOR="#000080"><b>

<p ALIGN="center">КРИВЫЕ И ПОВЕРХНОСТИ </b></font></p>

<p ALIGN="center"><font SIZE="+2" COLOR="#000080"><b>Кубические сплайны,
кривые Безье, поверхности Кунса </b></font></p>

<p ALIGN="JUSTIFY"><a NAME="b1"></a><font FACE="Times New Roman"><b>Цель работы:</b>
: изучение математических методов, моделей и
программных средств построения кубических
сплайнов, кривых Безье и поверхностей Кунса.</font> </p>

<p ALIGN="JUSTIFY"><a NAME="b2"></a><b><font FACE="Times New Roman">Порядок
выполнения работы:</font></b> </p>

<ul>
  <li><font FACE="Times New Roman">изучить <u><font COLOR="#0000FF"><a HREF="#b3">теоретическую
    часть</a></font></u></font>;</li>
  <li><font FACE="Times New Roman">подготовить <u><font COLOR="#0000FF"><a
    HREF="#b3">исходные данные</a></font></u></font> <font
    FACE="Times New Roman">и выполнить <a href="#b13">экспериментальную
    часть</a></font>;</li>
  <li><font FACE="Times New Roman">сделать <u><font COLOR="#0000FF"><a HREF="#b4">графическую
    интерпретацию</a></font></u> полученных результатов</font>;</li>
  <li><font FACE="Times New Roman">ответить на <font COLOR="#0000FF"><u><a
    HREF="#b5">контрольные вопросы</a></u></font></font>;</li>
  <li>оформить отчет.</li>
</ul>
<font COLOR="#0000FF" FACE="Times New Roman"><u><a HREF="#b4">

<p ALIGN="JUSTIFY">Примеры</a></u></font> </p>

<p ALIGN="JUSTIFY"><font COLOR="#0000FF" FACE="Times New Roman"><u><a HREF="#b6">Список
рекомендуемой литературы</a></u></font> </p>

<p ALIGN="JUSTIFY"><font SIZE="-1">&nbsp;</font> </p>

<p ALIGN="JUSTIFY"><a NAME="b3"></a><u><font FACE="Arial">Теоретическая
часть</font></u> </p>

<p>Кубические сплайны. Физически сплайн можно
представить в виде длинной узкой рейки из дерева
или пластика, которую используют для проведения
кривой между заданными точками. Рейке придают
форму с помощью свинцовых грузов. При изменении
числа и положения грузов рейка изгибается и
может проходить через заданные точки, в
результате чего кривая оказывается гладкой. Если
физически сплайн рассматривать как тонкую
упругую балку с модулем Юнга Е, то изгибающий
момент </p>

<p ALIGN="JUSTIFY">где I - момент инерции; R(x) - радиус
кривизны. Для небольших изгибов радиус
кривизны,R(x) может быть заменен 1/у' ', где штрихи
означают вторую производную по х. Таким образом
мы имеем </p>

<p ALIGN="JUSTIFY">Заменяя действие грузов реакцией опор,
можно считать момент М(x) линейной функцией от
расстояния между опорами. Принимая М(х) = А + Вх и
интегрируя вышеуказанное уравнение дважды,
находим, что физически сплайн описывается
кубическим полиномом. </p>

<p ALIGN="JUSTIFY">Вообще математическое описание
сплайна является кусочным полиномом степени к с
непрерывными производными порядка к-1 в местах
соединений между сегментами. Таким образом,
кубический сплайн имеет непрерывность второго
порядка в местах соединений. </p>

<p ALIGN="JUSTIFY">Кусочные сплайны полиномов низкой
степени обычно более пригодны для формирования
кривой, проходящей через серию точек.
Использование полиномов низкой степени упрощает
требования к вычислениям и уменьшает числовые
погрешности, которые возникают с увеличением
порядка кривых. Эти погрешности могут приводить
к нежелательному отклонению, когда несколько
точек должны быть соединены в общую кривую.
Однако, поскольку полиномом низкой степени
нельзя описать соединение произвольного ряда
точек, то необходимы смежные полиномиальные
сегменты. Общим методом, основанным на этих
рассуждениях и аналогии с физическим сплайном,
является использование серии кубических
сплайнов с каждым сегментом, соединяющим только
две точки. Кроме того, кубический сплайн
предпочтителен, поскольку он представляет собой
пространственную кривую самой низкой степени,
которая допускает точку изгиба, т.е. имеет
возможность изгибаться в пространстве. </p>

<p ALIGN="JUSTIFY">Уравнение единственного
параметрического кубического сплайнового
сегмента в элементах параметра t имеет вид: </p>

<p ALIGN="JUSTIFY">причем P(t)=I(t)y(t)z(t) I,P(t) можно представить
в виде вектора положения любой точки на сплайне.
Он имеет три компонента x(t), y(t), z(t), которые могут
быть рассмотрены, как декартовы координаты этого
вектора. Коэффициенты Bi определяются с помощью
четырех граничных условий для сплайнового
сегмента. </p>

<p ALIGN="JUSTIFY">Пусть данной парой точек, через
которые проходит криволинейный сегмент, будут
точки P1, P2 (рис.1.). Соответствующие касательные
векторы к этим заданным точкам определяются
величинами P’1, P’2, которые являются
производными по параметру t. внутри кубического
сегмента параметр t изменяется между двумя
значениями концевых точек t1 и t2. Чтобы упростить
расчеты, можно положить t1=0. Требуемые граничные
условия для каждого кубического сегмента
определяются параметрами двух концевых точек и
касательного век тора в каждой из них. Для
единственного сегмента между точками P1 и Р2 эти
условия задаются выражениями: </p>

<p ALIGN="center">Р(0) =Р1; </p>

<p ALIGN="center">P(t2) = Р2; </p>

<p ALIGN="JUSTIFY">Четыре соотношения следуют из
уравнений (1) и (2): Р(0) = В1 = Р1; (3) </p>

<p ALIGN="JUSTIFY">P(t2)= Bi(t**(i-1))I = Bl+B2*t2+B3*(t2**2)+B4(t2**3) (5) </p>

<p ALIGN="JUSTIFY">Решая эти уравнения относительно ВЗ и
В4 получим: </p>

<p ALIGN="JUSTIFY">с учетом того ,что Bl=Pl и B2=Р'1. Эти
значения В1, B2, ВЗ, и В4 </p>

<p ALIGN="JUSTIFY">определяют кривую для кубического
сплайна. Форма кубического сплайнового сегмента
зависит от положения концевой точки и
касательных векторов. В результате заметим, что
значение параметра t=t2 получается в точке на
конце сегмента. Поскольку каждый из векторов
концевых точек и векторов, касательных в них,
имеют по три компоненты, то параметрическое
уравнение для кубической пространственной
кривой зависит от 12 векторных величин и значения
параметра t на конце сегмента. Подстановка
соотношений (3), (4), (7) и (8) в формулу (1) дает
уравнение для кубического сплайнового сегмента: </p>

<p ALIGN="JUSTIFY">Уравнение (9) справедливо для одного
кубического сплайнового сегмента. Оно может быть
обобщено для любых двух смежных кубических
сегментов Pk(t) и Pk+1(t), причем 1&lt;&lt;=k&lt;=n-2, где n-число
заданных точек, через которые должна проходить
кривая(рис1б). Обобщенные уравнения записываются
в виде: </p>

<p ALIGN="JUSTIFY">при условии, что изменение параметра
для первого сегмента находится в пределах
0&lt;=t&lt;=t2, для второго 0&lt;=t&lt;=t3 и т.д. Например, если
охарактеризованы только три вектора положения
(заданные точки), то известными условиями для
всей кривой между точками Р1 и РЗ являются
векторы положения P1, P2, РЗ и векторы, касательные
в точках на концах кривой, т.е. P'1 и Р'3. </p>

<p ALIGN="JUSTIFY">Чтобы обеспечить непрерывность
второго порядка для кубического сплайна,
необходимо наложить условие постоянства
кривизны во внутренней точке соединения двух
промежутков. Это означает , что вторая
производная P''(t) непрерывна в месте соединения.
Из уравнения (1) имеем: P''(t) =(i-1) (i-2)Bi(t))**(i-3); t1&lt;=t&lt;=t2
(12) В конце первого кубического сплайнового
сегмента, где t=t2, P'' =6B4*t2+2B3 и в начале второго
сплайнового сегмента, где t=0, Р' '= 2*ВЗ. Приравнивая
эти два результата получаем: </p>

<p ALIGN="JUSTIFY">Умножение на t2t3 и группировка членов
этого уравнения даст соотношение (14): </p>

<p ALIGN="JUSTIFY">которое может быть решено для Р'2 -
неизвестного касательного вектора во
внутренней, точке соединения. Снова заметим, что
концевые значения параметра t т.е. t2 и t3
встречаются в результирующем уравнении.
Приведенные результаты для n заданных точек
могут быть обобщены для того, чтобы получить n-1
кубических сплайновых сегментов в зависимости
от положения, наклона, а также непрерывности
кривизны во всех внутренние точках сочленения
I1,2I. </p>

<p ALIGN="center"><font color="#FF0000">Кривые Безье.</font><font
color="#00FF40"> </font></p>

<p ALIGN="JUSTIFY">Во многих методам построения
трехмерные кривых получаемая кривая проходит
через заданные точки , т.е. эти методы являются
методами интерполяции. Во многих случаях эти
методы имеют недостатки, которые делают их
малопригодными для систем построения кривых в
диалоговом режиме. Это объясняется тем, что
задание формы кривой с помощью таких числовых
характеристик, как направление и модуль
касательных векторов не обеспечивает
правильности построения кривой, т.е. не всегда
существует связь между числами и формой кривой.
Кроме того методы подгонки трехмерных кривых в
результате дают кривую одного и того же порядка,
который не меняемся от сплайна к сплайну. Для
того, чтобы увеличить кривизну, нужно вводить
больше точек, формируя лишь большее число
кубических сплайнов. </p>

<p ALIGN="JUSTIFY">Безье I 1,2 I предложен метод изображения
кривой, который создает у пользователя более
естественное восприятие и позволяет изменять
форму кривой и ее порядок за счет просто
задаваемых параметров до тех пор, пока не будет
достигнут желаемый результат. Кривая Безье
определяется “вершинами” многоугольника,
который единственным образом задаёт форму
кривой Безье. Кривой принадлежат первая и
последняя вершины, в то время как другие вершины
характеризуют производные, порядок и вид кривой.
Таким образом, кривая задается посредством
открытого многоугольника (рис.2). </p>

<p ALIGN="JUSTIFY">Так как вид кривой зависит от формы
многоугольника, то изменение положения вершин
этого многоугольника создает у пользователя
более ясное представление связи между входом и
выходом. </p>

<p ALIGN="JUSTIFY">Для того чтобы увеличить порядок
любого криволинейного сегмента нужно лишь
задать дополнительные вершины. Такая методика
отличается значительной гибкостью, кроме того,
при использовании кривых Безье упрощается
внесение изменений. </p>

<p ALIGN="JUSTIFY">Математически кривая Безье
описывается полиномиальной функцией, которая
осуществляет интерполяцию между первой и
последней вершинами. Полиномы Безье относятся к
классу полиномов Берштейна. Базисная функция
задается соотношением: </p>

<p ALIGN="center">Jn,i(t) = (n/1) (t**i)(l-t)**(n-i), (15) </p>

<p ALIGN="JUSTIFY">где </p>

<p ALIGN="center">(n/i) = (n!)/(i!)(n-1)!, 0 &lt;=i&lt;=n; (16) </p>

<p ALIGN="left">n - степень полинома; I - порядковый номер
отдельной вершины. </p>

<p ALIGN="JUSTIFY">Вообще, n -й порядок полинома
характеризуется п+1 вершинами. В этом случае
точки кривой задаются выражением; </p>

<p ALIGN="center">P(t) = Pi * Jn,i(t), 0&lt;t&lt;l, (17) </p>

<p ALIGN="left">где Pi - функция компонент векторов
различных вершин. В начальной точке
криволинейного сегмента: </p>

<p ALIGN="center">Jn,0 (О) = (n!(1)(l-O)**(n-O))/n! == 1 (18) </p>

<p ALIGN="left">В конечной точке криволинейного
сегмента имеем: </p>

<p ALIGN="center">Jn,n(1) = ((n!)(1)**n(0)**n-n)/n!(l) (19) У</p>

<p ALIGN="left">равнения (18), (19) и (17) показывают, что Р(0) =
РО и Р(1) = Рn, т.е. вершины РО и Рn действительно
являются начальной и конечной точками
криволинейного сегмента. Другой особенностью
интерполяционной функции является то, что
максимальные значения достигаются при t=i/n. Этот
максимум определяется как: </p>

<p ALIGN="center">Jn,i(i/n) = ((n/i)(I**i)(( n-1 )**(n-i)))/(n**n) (20) </p>

<p ALIGN="JUSTIFY">Например, для кубического полинома:
J3,1(1/3) = 4/9, J3,2(2/3) = 4/9. </p>

<p ALIGN="JUSTIFY">Для того чтобы построить кубический
криволинейный сегмент, необходимо лишь задать
четыре вершины многоугольника и затем, используя
уравнения (15) и (16), вычислить точки вдоль кривой
для 0&lt;=t&lt;=1,0. Хотя нет необходимости в задании
производных при построении отдельных кривых
Безье, при сопряжении двух кривых такого типа эти
производные приходится задавать для получения
одинакового наклона и кривизны в точке
сопряжения. </p>

<p ALIGN="JUSTIFY">На практике может возникнуть
необходимость увеличения порядка кривой, т.е.
увеличения числа вершин многоугольника для того
чтобы сохранить непрерывность производной более
высокого поряд-ка. Это сделать легче, чем
расщепить всю кривую на меньшие сег-менты.
Простота увеличения порядка сегментов является
одним из основных преимуществ метода Безье. </p>

<p ALIGN="JUSTIFY">ПРИМЕР. Кривая Безье. </p>

<p ALIGN="JUSTIFY">Предположим, что РО = I1 1I, P1==I2,3I и P2=I4 3I
являются векторами положения многоугольника
Безье. Согласно уравнениям (15) - (17) имеем: </p>

<p ALIGN="center">P(t)== PiJn,i(t), </p>

<p ALIGN="JUSTIFY">где </p>

<p ALIGN="center">Jn,i(t) = (n/i) (t**i) (1-t)**(n-1) и (n/I)=n!/(i!)(n-i)!; </p>

<p ALIGN="left">Здесь n=3 поскольку мы имеем четыре
вершины. </p>

<p ALIGN="left">Отсюда, </p>

<p ALIGN="center">(n/i) = 6/(i!(3-I)!; J3,0(t)= (1-t)**3; J3,l(t)= 3t(l.-t)**2;
J3,2(t)=3((t)**2)(i-t); J3,3(t)= t**3. </p>

<p ALIGN="left">Таким образом,</p>

<p ALIGN="center">p(t)= (Р0 x J3,0) + (PI x J3,1) + (P2 x J3,2) + (P3 x J3,3). </p>

<p ALIGN="center">Вычислив значение Jn, i для некоторых
значений t имеем : </p>

<p ALIGN="left">Р(0) = Po = I 1,1 I; </p>

<p>P(0,15) = 0,614Ро + 0,325Р1 + 0,057Р2 + 0,0034РЗ=I1,5 1,765I </p>

<p>Р(0,35) = 0,275Ро + 0,444Р1 + 0,239Р2 + 0,043РЗ ==I2,248 2,367I </p>

<p>Р(0,5) = 0,125Po + 0.375Р1 + 0,375Р2 + 0,125РЗ ==I2,75 2,5I </p>

<p>Р(0,65)= 0,043Ро + 0,239Р1 + 0,444Р2 + 0,275РЗ = I3,122 2,36I </p>

<p>Р(0,85)=0,0034Ро + 0,514Р1 +0,325Р2 + 0,614РЗ == I3,248 1,75I </p>

<p>Р(1) == Р3= I 3 1I </p>

<p ALIGN="center"><font color="#FF0000">Поверхность Кунса. </font></p>

<p ALIGN="JUSTIFY">Если известны четыре задающие
граничные кривые P(u,0) ,Р(и,1) &lt; P(0,w) и P(l,w), то можно
предположить, что сумма уравнений ли-нейчатых
поверхностей, построенных на граничных кривых,
должна дать желаемый результат. Суммируя эти
уравнения, получаем: </p>

<p ALIGN="center">Q(u,w) = P(u,0) (1-w) + P(u,1)w + P(0,w)(1-u) +P(1,w) (21) </p>

<p ALIGN="left">Однако исследование уравнения (21) в
угловых точках поверх-ности дает соотношение: </p>

<p ALIGN="left">Q(0,0) = Р(0,0) + Р(0,0) и т.д. а на краях: Q(О,w)=Р(0,0)
(l-w) + P(0,l)w + Р(О,w). </p>

<p ALIGN="left">Как видно, ни одно из них не
соответствует исходным данным. </p>

<p ALIGN="JUSTIFY">Исследование уравнения (21) показывает,
что несоответствие возникает из-за того, что
угловые точки просчитываются дважды поскольку,
например, Р(0,0) содержится в описании граничных,
кривых Р(u,0) и P(0,w), а точка Р(1,1) - в уравнениях
кривых Р(u,1) и P(l,w).I 4 I. Правильный результат можно
получить, вычитая лишние угловые точки, что
приводит к выражению: </p>

<p ALIGN="center">Q(u,w) = P(u,0) (1-w) •+• P(u,l)w + P(0,w)(l-u) + P(l,w)u - P(O,O)
(1-u) (1-w) - P(0,1) (l-u)w - P(l-O)u(1-w) - P(l,l)uw. (22) </p>

<p ALIGN="JUSTIFY">Пример такой поверхности приведен на
рис.3 </p>

<p ALIGN="JUSTIFY">Такое линейное объединение четырех
граничных кривых является простейшей
поверхностью Кунса. В общем случае поверхность
Кунса задается в матричной форме и имеет вид: </p>

<p ALIGN="JUSTIFY">Если можно записать более компактно: </p>

<p ALIGN="JUSTIFY">Функции (1-u), и, (1-w), w называются
весовыми функциями. С их помощью по граничным
кривым можно получить описание внутренней формы
поверхности. </p>

<p ALIGN="JUSTIFY"><u><font FACE="Arial"><a NAME="b13">Экспериментальная
часть</a></font> </u></p>

<p ALIGN="JUSTIFY">Рассмотренные процедуры
преобразования графической информации написаны
на языке программирования БЕЙСИК и реализованы
на ПЭВМ типа IBM PC в операционной среде MS DOS. </p>

<p ALIGN="JUSTIFY">Программа генерации кубических
сплайнов SPLINE имеет сложную иерархическую
структуру, состоящую из четырех программных
модулей. Первый модуль содержит 25 операторов. Из
него идет обращение к трем другим программным
модулям„ содержащим соответственно 24,34,23
оператора. </p>

<p ALIGN="JUSTIFY">Исходные данные: </p>

<ul>
  <li><p ALIGN="JUSTIFY">координаты точек задающего
    многоугольника;</p>
  </li>
  <li><p ALIGN="JUSTIFY">количество точек многоугольника; </p>
  </li>
  <li><p ALIGN="JUSTIFY">количество промежуточных точек. </p>
  </li>
</ul>

<p ALIGN="JUSTIFY">Результаты расчета: </p>

<ul>
  <li>длина хорды между соседними точками; </li>
  <li>координаты промежуточных точек. </li>
</ul>

<p ALIGN="JUSTIFY">Программа построения сегментов кривой
Безье BEZIER имеет структуру , состоящую из двух
программных модулей. Первый модуль, содержащий 58
операторов, является головной программой. Из
него идет обращение ко второму программному
модулю ( подпрограмме вычисления факториала ),
содержащему 11 операторов. Исходные данные: </p>

<ul>
  <li>координаты вершин задающего многоугольника; </li>
  <li>количество точек сегментов кривой Безье. </li>
</ul>

<p ALIGN="JUSTIFY">Результаты расчета: координаты точек
сегментов. Программа построения линейной
поверхности Кунса состоит из одного модуля,
содержащего, 48 операторов.(COONS ). </p>

<p ALIGN="JUSTIFY">Исходные Данные : </p>

<ul>
  <li><p ALIGN="JUSTIFY">координаты точек граничных кривых. </p>
  </li>
</ul>

<p ALIGN="JUSTIFY">Результаты расчета:</p>

<ul>
  <li><p ALIGN="JUSTIFY">координаты точек поверхности Кунса. </p>
  </li>
</ul>

<p><a NAME="b5"></a></p>
<font SIZE="+0" FACE="Arial"><u>

<p>Контрольные вопросы</u></font> 

<ol>
  <li>Какова физическая интерпретация понятия
    “сплайн” <a HREF="#b3">???</a></li>
  <li>Отчего зависит форма, кубического сплайнового
    сегмента<a HREF="#b3">???</a></li>
  <li>Чем определяется кривая Безье<a HREF="#b3">???</a></li>
  <li>Как формируется машинное описание кривой Безье<a
    HREF="#b3">???</a></li>
  <li>Как формируется поверхность Кунса<a HREF="#b3">???</a></li>
</ol>

<p><a NAME="b6"></a></p>
<font SIZE="+0" FACE="Arial"><u>

<p>Список рекомендуемой литературы</u></font> 

<ol>
  <li>Роджерс Д., Адам Дж. Математические основы
    машинной гра­фики/Пер. с англ. -М.: Машиностроение.
    1980. -240 с.</li>
  <li>Роджерс Д. Алгоритмические основы машинной
    графики/ Пер.с англ. –М: Мир, 1989.-512с.</li>
  <li>Март и нес Ф. Синтез изображений. Принципы,
    аппаратное и программное обеспечение:
    Пер.сфранц. - М.: Радио и связь, 1990. - 192с., ил.</li>
  <li>Принс М.Д. Машинная графика и автоматизация
    проекти­рования: Пер. с англ.- М.: Сов. радио, 1975.-23.2c
    .: 232с</li>
  <li>Морозов К.К. Одиноков В.Г. Использование ЭЦВМ при
    конструировании некоторых узлов
    радиоэлектронной аппарату­ры, М., «Сов.радио», 1972,
    104с.</li>
  <li>Дрейфус М., Ганглоф К. Практика программирования
    на; Фортране. М., Мир, 1978, 224с.</li>
</ol>
<span <p ALIGN="JUSTIFY">

<hr size="1" width="100%" noshade color="gray" align="center">
</span>

<p align="center"><a HREF="Введение.HTMl">Введение </a>&nbsp;&nbsp;&nbsp; <a
HREF="lab01.HTMl">1</a>&nbsp;&nbsp;&nbsp; <a HREF="lab02.HTMl">2</a>&nbsp;&nbsp;&nbsp; <a
HREF="lab03.HTMl">3</a>&nbsp;&nbsp;&nbsp;<a HREF="lab04.HTMl"> 4</a>&nbsp;&nbsp;&nbsp; <a
HREF="lab05.HTMl">5</a>&nbsp;&nbsp;&nbsp; <a HREF="lab06.HTMl">6</a>&nbsp;&nbsp;&nbsp; <a
HREF="lab07.HTMl">7</a>&nbsp;&nbsp;&nbsp; <a HREF="lab08.HTMl">8</a>&nbsp;&nbsp;&nbsp;
9&nbsp;&nbsp;&nbsp; <a HREF="lab10.HTMl">10</a></p>
<span <p ALIGN="JUSTIFY">

<hr size="1" width="100%" noshade color="gray" align="center">
</span>
</body>
</html>
