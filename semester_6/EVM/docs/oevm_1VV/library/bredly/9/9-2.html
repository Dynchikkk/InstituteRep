<html><meta http-equiv="Content-Type" content="text/html; charset=windows-1251">



<body background="../images/bgrwhite.gif">
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1251">
 <TITLE>Дэвид Дж. Брэдли</TITLE>
<h2>9.2. Самотестирование при включении питания</h2>

<p>
IBM PC выполняет процедуру самопроверки после каждого сброса системы, включая момент, когда появляется питание. Такая проверка преследует две цели: она выполняет быструю проверку основных элементов системы и инициализирует основные аппаратные компоненты.
<p>
Как системный тест, процедура POST образует первую часть трехуровнего диагностического пакета фирмы IBM для ее персональной ЭВМ. Процедура POST выполняется всякий раз при включении системы. Эта быстрая проверка тестирует работу системы и обнаруживает ошибку до того, как она повлияет на выполнение программы. Программы, обеспечивающие второй уровень диагностики приходит вместе с каждой машиной в составе руководства по работе на IBM PC; эта дискета (или кассета) содержит программу диагностики, она проверяет отдельно каждый компонент машины. Эта диагностическая программа определяет, какую часть машины покуптель должен вернуть для обслуживания, если найдена ошибка. Наконец, фирма IBM поставляет усовершенствованноедиагностическое средство. Это средство, доступное за дополнительную плату, определяет, какой из сменных узлов не работает. Это диагностическое средство создано для обслуживающего персонала, работающего на таких машинах. Правда вы можете купить для себя и усовершенствованные диагностические тесты.
<p>
Начало процедуры POST, возможно, будет трудно найти из-за того, что оно находится в самом конце листинга. Когда микропроцессор 8088 сбрасывается (или когда включается питание), он начинает работу с адреса 0FFFF:0000H. Эта ячейка находится всего в 16 байтах от самого конца адресного пространства микропроцессора 8088. Этого места хватает для команды перехода на настоящую программу POST. Как вы видите, команда FAR JMP передает управление на метку START, которая и есть начало процедуры POST. Фирма IBM использует оставшиеся байты в конце памяти под дату;
эта дата - момент выпуска ПЗУ в серию. Способ запуска процедуры POST также объясняет, почему фирма IBM расположила ПЗУ в верхних адресах памяти. Именно здесь микропроцессор начинает выполнение программы после сброса. Системное ПЗУ, содержащее программу инициализации машины, должно иметь некоторую информацию по адресу 0FFFFH:0000H. Так что есть смысл помещать все ПЗУ в конце памяти. Также, есть смысл поместить ОЗУ в нижних адресах, оставив в нем векторы прерываний. Возможность модификации кодов в этих векторах в большой степени увеличивает универсальность программы BIOS. Вообще процедура POST состоит из неинтересных кодов. Многие последовательности команд не имеют никакого смысла. Если вы посмотрите на начальную последовательность команд, то увидите, что они не делают ничего - если с микропроцессором ничего не случилось. Если вас не интересует написание диагностических программ нет смысла изучать технику процедуры POST. Отметим некоторые действия процедуры POST, чтобы показать область проверки ошибок. Процедура POST проверяет все ПЗУ системной платы, считая контрольную сумму. Этот тест складывает все байты модулей ПЗУ. При сложении перенос из 8-битового результата игнорируется. Если окончательный результат нулевой, ПЗУ прошло проверку. Конечно,
перед тем, как запустить ПЗУ в серию, фирма IBM обеспечила, чтобы сумма каждого ПЗУ была равна нулю. Если ПЗУ плохое, этот тест находит ошибку. Процедура POST также проверяет всю оперативную память в системе. Переключатели не системной плате сообщают процедуре POST, сколько у системы есть памяти в наличии. Каждый бит памяти проверяется, может ли он быть установлен в единицу и сброшен в нуль. По окончании теста процедура POST записывает нули по всем адресам памяти. Это означает, что если вы написали программу, которая будет работать сразу же после процедуры POST, содержимое всей памяти окажется нулевым. Но надеяться, что некоторая другая программа инициализирует поля данных вашей программы - плохой стиль программирования. чтобы быть в этом
уверенным, лучше делать это самому. Последнее, что можно сказать про процедуру POST - то, что она
<p>
<table align="center">
  <tr><th colspan="2">Номер прерывания</th><th>Использование в ROM BIOS</th></tr>
  <tr><th colspan="3">Аппаратные прерывания</th></tr>
  <tr><td>2</td><td>02H</td><td>Ошибка четности в памяти</td></tr>
  <tr><td>5</td><td>05H</td><td>Печать экрана</td></tr>
  <tr><td>8</td><td>08H</td><td>Текущее время</td></tr>
  <tr><td>9</td><td>09H</td><td>Клавиатура</td></tr>
  <tr><td>14</td><td>OEH</td><td>Дискета</td></tr>
  <tr><th colspan="3">Драйверы BIOS</th></tr>
  <tr><td>16</td><td>10H</td><td>Видео</td></tr>
  <tr><td>17</td><td>11H</td><td>Проверка оборудования</td></tr>
  <tr><td>18</td><td>12H</td><td>Размер памяти</td></tr>
  <tr><td>19</td><td>13H</td><td>Дискета</td></tr>
  <tr><td>20</td><td>14H</td><td>Асинхронные</td></tr>
  <tr><td>21</td><td>15H</td><td>Кассета стриммера</td></tr>
  <tr><td>22</td><td>16H</td><td>Клавиатура</td></tr>
  <tr><td>23</td><td>17H</td><td>Принтер</td></tr>
  <tr><td>24</td><td>18H</td><td>Точка входа Бэйсика для кассеты</td></tr>
  <tr><td>25</td><td>19H</td><td>Точка входа в процедуру первичной загрузки</td></tr>
  <tr><td>26</td><td>1AH</td><td>Текущее время</td></tr>
  <tr><th colspan="3">Процедуры управляемые пользователем</th></tr>
  <tr><td>27</td><td>1BH</td><td>Прерывание клавиатуры</td></tr>
  <tr><td>28</td><td>1CH</td><td>Квантование времени</td></tr>
  <tr><th colspan="3">Процедуры управляемые пользователем</th></tr>
  <tr><td>29</td><td>1DH</td><td>Параметры видеомонитора</td></tr>
  <tr><td>30</td><td>1EH</td><td>Параметры дисковода</td></tr>
  <tr><td>31</td><td>1FH</td><td>Графические символы видеомонитора</td></tr>
</table>
<p class="center">
Фиг. 9.1 Векторы прерываний, используемые ROM BIOS
<p>
инициализирует векторы прерываний для BIOS. Программы получают доступ к BIOS с помощью векторов прерывания. Сами по себе эти подпрограммы находятся в модуле ПЗУ, в том же, что и процедура POST. Перед тем, как процедура POST передаст управление операционной системе, она делает так, чтобы каждая входная точка BIOS была записана в соответствующий вектор прерывания. BIOS использует векторы прерываний для прерываний от 2 до 01FH. Техническое описание содержит листинг
векторов прерывания, в котором показаны номера прерываний и первоначальное содержимое векторов. На Фиг.9.1 изображена часть этой таблицы, которая будет использоваться в описании BIOS.

<p><div align="center"><a href="../index.html"><img src="../images/index.gif" border=0 alt=""></a></div><p></p>

</body>
</html>
