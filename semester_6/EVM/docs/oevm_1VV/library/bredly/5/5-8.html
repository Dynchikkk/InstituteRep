<html><meta http-equiv="Content-Type" content="text/html; charset=windows-1251">



<body background="../images/bgrwhite.gif"><head>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1251">
 <TITLE>Дэвид Дж. Брэдли</TITLE>
</head>



<h2>5.8. Создание программы на языке Ассемблера</h2>

<p>
Путь от идеи к готовой для выполнения программы состоит из нескольких этапов. В данном разделе рассматриваются этапы создания программы на языке ассемблера для IBM PC. К обсуждаемым здесь средствам относятся: строковый редактор, ассмеблер, редактор связей (компоновщик) и отладчик. С помощью редактора создаются исходные программы на языке ассемблера. Ассемблер преобразует исходную программу в объектный код, который очень близок кмашинному языку.    Редактор связей трансформирует объектный код в файл типа .EXE, содержащий программу, которая готова к выполнению. И наконец, программа-отладчик может оказать помощь в выявлении ошибок в программе.
<p>
СТРОКОВЫЙ РЕДАКТОР ДОС
<p>
Редактор строк формирует текстовые файлы. Содержимое текстового файла представлено в коде ASCII. Редактор позволяет вводить нужный вам текст в файл. Если затем понадобится изменить файл, то для этого опять используется редактор.
<p>
Редактор строк (EDLIN) входит в состав DOS IBM PC. Файл EDLIN.COM является внешней командой, т.е. загружается в память только по запросу. Для запуска редактора должна быть выполнена
следующая команда:
<dir>
<pre>
<b>
A&gt;EDLIN FILE.ASM
</b>
</pre>
</dir>
<p>
где FILE.ASM - имя текстового файла, с которым будет работать редактор. Файл FILE.ASM уже может
существовать, как в случае, когда вы вносите изменения в сформированную программу. Если же такого файла еще нет, то он будет создан с помощью редактора EDLIN. По окончании редактирования результирующий текст помещается в файл FILE.ASM. Если в данном редактировании файл не создавался, то редактор EDLIN выполняет переименование старого варианта файла FILE.ASM в файл FILE.BAK (backup - копия). Создание копии файла позволяет с ее помощью устранить любые
серьезные ошибки, допущенные при редактировании файла. Вы ликвидируете файл со внесенными при редактировании ошибками и переименовываете файл .BAK в файл .ASM. Таким образом, это служит подстраховкой при редактировании текста.
<p>
Редактор EDLIN является редактором строк. Каждую строку текста он обрабатывает отдельно и этим отличается от экранного редактора, который выводит на экран целый фрагмент редактируемого текстового файла. При работе с экранным редактором, таким как Персональный Редактор (Personal Editor), разработанный фирмой IBM, вы перемещаете курсор и осуществляете редактирование в любом месте экрана в то время, как с помошью редактора EDLIN каждый раз редактируется только одна строчка текста. Если вы собираетесь основательно заняться программированием на языке ассемблера, то вам лучше пользоваться экранным редактором. Поставляемый фирмой IBM Персональный Редактор является очень хорошим экранным редактором текста. Именно с его помощью были подготовлены все примеры в этой книге. Редактор EDLIN рассматривается здесь только потому, что он входит в состав DOS. Однако учмтывая, что это не лучший вариант редактора, описание редактора EDLIN включает только краткое упоминание его команд и соответствующий
пример. Для того, чтобы подробней ознакомиться с командами редактора EDLIN, следует обратиться к руководству по DOS.
<p>
На Фиг.5.7 подытожены сведения о командах редактора EDLIN. При разборе примера мы будеи на них ссылаться.
<p>
<table align="center">
  <tr><th>Действие</th><th>Синтаксис</th>
  <tr><td class="center">Изменение строки</td><td>[n] A</td></tr>
  <tr><td class="center">Уничтожение строки</td><td>[строка][,строка] D</td></tr>
  <tr><td class="center">Редактировать строку</td><td>[строка]</td></tr>
  <tr><td class="center">Конец редактирования</td><td>E</td></tr>
  <tr><td class="center">Вставка строки</td><td>[строка] I</td></tr>
  <tr><td class="center">Просмотр строк</td><td>[строка][,строка] L</td></tr>
  <tr><td class="center">Выход из редактора</td><td>Q</td></tr>
  <tr><td class="center">Замена контекста</td><td>[строка][,строка] [?] ЗаменяемаяСтрока [&lt;F6&gt;Строка]</td></tr>
  <tr><td class="center">Поиск контекста</td><td>[строка][,строка] [?] СтрокаПоиска</td></tr>
  <tr><td class="center">Записать строки </td><td>[n] W</td></tr>
</table>
<p class="center">     
Фиг. 5.7 Команды EDLIN (Copyright IBM 1981)
<p>
Фиг. 5.8 иллюстрирует выполнение двух этапов редактирования с использованием редактора EDLIN. В первой части редактирования создается файл с именем FIG5=8.ASM. Сообщение &quot;New file&quot; (&quot;новый файл&quot;) указывает на то, что файла с таким именем до этого не было. Символом &quot;*&quot; обозначается запрос со стороны редактора EDLIN. Всякий раз, когда на дисплее появляется этот символ, можно вводить любую из команд, приведенных на Фиг.5.7. Команда &quot;I&quot; позволяет вводить текст в файл. По мере ввода текста редактор EDLIN указывает на экране номера строк. Ввод порции текста завершается нажатием клавиши Control=Z (на листинге - ^Z).
Команда E завершает этап редактирования, записывает файл и возвращает управление DOS. На второй части Фиг. 5.8 показано редактирование файла, созданного в первой чати. Редактор вызывается той же самой командной строкой, а сообщение &quot;End of input file&quot; (&quot;конец ввода файла&quot;) указывает на то, что данный файл уже существует. Команда L выводит на экран текущее содержимое файла. В данном примере вносятся изменения в некоторые строки программы при выполнении команды редактирования. Если ввести символ &quot;3&quot;, то на дисплей будет
<dir>
<pre>
<b>

A&gt;EGLIN FIG5_8.ASM
New file
*I
      1:*      PAGE    ,132
      2:*CODE        SEGMENT
      3:*      ASSUME        CS:CODE
      4:*
      5:*START:      PROC    NEAR
      6:*      MOV     AX,CODE
      7:*      MOV     DS,AX
      8:*      RET
      9:*START:      ENDP
     10:*END
     11:*^C
*E
A&gt;
A&gt;EDLIN FIG5_8.ASM
End of input file
*L
      1:*      PAGE    ,132
      2: CODE        SEGMENT
      3:       ASSUME        CS:CODE
      4:
      5: START       PROC    NEAR
      6:       MOV     DS,AX
      7:       MOV     DS,AX
      8:       RET
      9: START       ENDP
     10: END
*3
      2:*CODE        SEGMENT
      2:*CODE        SEGMENT,DS:CODE
*5
      5:*START:            PROC    NEAR
      5:*START:      PROC    NEAR
*6
      6:*      MOV     AX,CODE
      6:*      MOV     AX,CS
*9I
      9:*
     10:*^C
*L
      1:*      PAGE    ,132
      2: CODE        SEGMENT
      3:       ASSUME        CS:CODE
      4:
      5: START       PROC    NEAR
      6:       MOV     DS,AX
      7:       MOV     DS,AX
      8:       RET
      9:
     10: START       ENDP
     11: END
   *E
   A&gt;
</b>
Фиг. 5.8 Пример работы с EDLIN
</pre>
</dir>
<p>
выведена третья строка, готовая для редактирования. У системы имеется набор встроенных команд
построчного редактирования, которые приведены на Фиг.5.9. Эти команды редактирования можно использовать как при работе с редактором EDLIN, как и всегда, когда осуществляется ввод символов с клавиатуры под управлением DOS, в частности, при вводе команд, относящизся к
командному процессору.
<p>
Вернемся к примеру, приведенному на Фиг. 5.8. После того, как строка с указанным номером выведена на дисплей, ее можно отредактировать с помощью команд DOS. Клавиша F3 позволяет повторно вывести строку на дисплей и вносить изменения, начиная с конца строки. На примере редактирования строки 5 показано использование клавиша DEL для удаления из поля метки
символа &quot;:&quot;. При редактировании строки 6 используется клавиша (курсор вправо) для установки курсора после &quot;,&quot;. Вслед за этим код &quot;CODE&quot; заменяется на символ &quot;CS&quot;. Кроме того, для наглядности текста в данном примере производится вставка пустой строки перед строчкой 9. После этого опять выдается листинг файла для того, чтобы были видны внесенныепри редактировании изменения. Команда E - окончание редактирования - возвращает управление DOS.
<p>
<table align="center">
  <tr><th>Клавиша</th><th>Описание</th>
  <tr><td class="center">DEL</td><td>Уничтожение следующего символа в хранимой строке</td></tr>
  <tr><td class="center">ESC</td><td>Отмена редактирования хранимой строки</td></tr>
  <tr><td class="center">F1 или &gt;</td><td>Копировать символ из хранимой строки</td></tr>
  <tr><td class="center">F2</td><td>Копировать все символы до заданного</td></tr>
  <tr><td class="center">F3</td><td>Копировать оставшиеся символы на экран</td></tr>
  <tr><td class="center">F4</td><td>Пропустить все символы до заданного</td></tr>
  <tr><td class="center">F5</td><td>Принять отредактированную строку для продолжения</td></tr>
  <tr><td class="center">INS</td><td>Вставить символ в строку (отмена - INS повторно)</td></tr>
</table>
<p class="center">     
Фиг. 5.9 Клавиши редактирования в DOS
<p>
Имеется и ряд других операций, которые можно выполнять с помощью редактора EDLIN и команж редактирования, вхадящих в DOS. Лучший способ изучить их - это просмотреть руководство по DOS и затем все операции попробовать. Однако в случае серьезных программных разработок лучше обратиться к экранному редактору.

<p><div align="center"><a href="../index.html"><img src="../images/index.gif" border=0 alt=""></a></div><p></p>

</body>
</html>
