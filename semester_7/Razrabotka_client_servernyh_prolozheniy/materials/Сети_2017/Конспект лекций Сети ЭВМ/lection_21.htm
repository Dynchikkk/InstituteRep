<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>История создания стандарта FDDI</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
</head>

<body>
<h3><a name="21_1"></a>21.1. История создания стандарта FDDI</h3>
      <P align=justify>Технология <I>Fiber Distributed Data Interface </I>- 
      первая технология локальных сетей, которая использовала в качестве среды 
      передачи данных оптоволоконный кабель. 
      <P align=justify>Попытки применения света в качестве среды, несущей 
      информацию, предпринимались давно - еще в 1880 году Александр Белл 
      запатентовал устройство, которое передавало речь на расстояние до 200 
      метров с помощью зеркала, вибрировавшего синхронно со звуковыми волнами и 
      модулировавшего отраженный свет. 
      <P align=justify>Работы по использованию света для передачи информации 
      активизировались в 1960-е годы в связи с изобретением лазера, который мог 
      обеспечить модуляцию света на очень высоких частотах, то есть создать 
      широкополосный канал для передачи большого количества информации с высокой 
      скоростью. Примерно в то же время появились оптические волокна, которые 
      могли передавать свет в кабельных системах, подобно тому, как медные 
      провода передают электрические сигналы в традиционных кабелях. Однако 
      потери света в этих волокнах были слишком велики, чтобы они могли быть 
      использованы как альтернатива медным жилам. Недорогие оптические волокна, 
      обеспечивающие низкие потери мощности светового сигнала и широкую полосу 
      пропускания (до нескольких ГГц) появились только в 1970-е годы. В начале 
      1980-х годов началось промышленная установка и эксплуатация оптоволоконных 
      каналов связи для территориальных телекоммуникационных систем. 
      <P align=justify>В 1980-е годы начались также работы по созданию 
      стандартных технологий и устройств для использования оптоволокнных каналов 
      в локальных сетях. Работы по обобщению опыта и разработке первого 
      оптоволоконного стандарта для локальных сетей были сосредоточены в 
      Американском Национальном Институте по Стандартизации - ANSI, в рамках 
      созданного для этой цели комитета X3T9.5. 
      <P align=justify>Начальные версии различных составляющих частей стандарта 
      FDDI были разработаны комитетом Х3Т9.5 в 1986 - 1988 годах, и тогда же 
      появилось первое оборудование - сетевые адаптеры, концентраторы, мосты и 
      маршрутизаторы, поддерживающие этот стандарт. 
      <P align=justify>В настоящее время большинство сетевых технологий 
      поддерживают оптоволоконные кабели в качестве одного из вариантов 
      физического уровня, но FDDI остается наиболее отработанной 
      высокоскоростной технологией, стандарты на которую прошли проверку 
      временем и устоялись, так что оборудование различных производителей 
      показывает хорошую степень совместимости. 
       
<h3><a name="21_2"></a>21.2. Основы технологии FDDI</h3>
      <P align=justify>Технология FDDI во многом основывается на технологии 
      Token Ring, развивая и совершенствуя ее основные идеи. Разработчики 
      технологии FDDI ставили перед собой в качестве наиболее приоритетных 
      следующие цели: 
      <UL>
        <LI>Повысить битовую скорость передачи данных до 100 Мб/с. 
        <LI>Повысить отказоустойчивость сети за счет стандартных процедур 
        восстановления ее после отказов различного рода - повреждения кабеля, 
        некорректной работы узла, концентратора, возникновения высокого уровня 
        помех на линии и т.п. 
        <LI>Максимально эффективно использовать потенциальную пропускную 
        способность сети как для асинхронного, так и для синхронного трафиков. 
        </LI></UL>
      <P align=justify>Сеть FDDI строится на основе двух оптоволоконных колец, 
      которые образуют основной и резервный пути передачи данных между узлами 
      сети. Использование двух колец - это основной способ повышения 
      отказоустойчивости в сети FDDI, и узлы, которые хотят им воспользоваться, 
      должны быть подключены к обоим кольцам. В нормальном режиме работы сети 
      данные проходят через все узлы и все участки кабеля первичного (Primary) 
      кольца, поэтому этот режим назван режимом Thru - "сквозным" или 
      "транзитным". Вторичное кольцо (Secondary) в этом режиме не используется. 
      <P align=justify>В случае какого-либо вида отказа, когда часть первичного 
      кольца не может передавать данные (например, обрыв кабеля или отказ узла), 
      первичное кольцо объединяется со вторичным (рис. 31), образуя вновь единое 
      кольцо. Этот режим работы сети называется Wrap, то есть "свертывание" или 
      "сворачивание" колец. Операция свертывания производится силами 
      концентраторов и/или сетевых адаптеров FDDI. Для упрощения этой процедуры 
      данные по первичному кольцу всегда передаются против часовой стрелки, а по 
      вторичному - по часовой. Поэтому при образовании общего кольца из двух 
      колец передатчики станций по-прежнему остаются подключенными к приемникам 
      соседних станций, что позволяет правильно передавать и принимать 
      информацию соседними станциями. 
      <P align=justify>В стандартах FDDI отводится много внимания различным 
      процедурам, которые позволяют определить наличие отказа в сети, а затем 
      произвести необходимую реконфигурацию. Сеть FDDI может полностью 
      восстанавливать свою работоспособность в случае единичных отказов ее 
      элементов. При множественных отказах сеть распадается на несколько не 
      связанных сетей. 
      <CENTER>
  <P><img src="images/2_031.gif" width="315" height="244"> 
  <P><I>Рис. 31. Реконфигурация колец FDDI при отказе</I></CENTER>
      <P align=justify>Кольца в сетях FDDI рассматриваются как общая разделяемая 
      среда передачи данных, поэтому для нее определен специальный метод 
      доступа. Этот метод очень близок к методу доступа сетей Token Ring и также 
      называется методом маркерного (или токенного) кольца - token ring (рис. 
      32, а). 
      <P align=justify>Станция может начать передачу своих собственных кадров 
      данных только в том случае, если она получила от предыдущей станции 
      специальный кадр - токен доступа (рис. 32, б). После этого она может 
      передавать свои кадры, если они у нее имеются, в течение времени, 
      называемого временем удержания токена - Token Holding Time (THT). После 
      истечения времени THT станция обязана завершить передачу своего очередного 
      кадра и передать токен доступа следующей станции. Если же в момент 
      принятия токена у станции нет кадров для передачи по сети, то она 
      немедленно транслирует токен следующей станции. В сети FDDI у каждой 
      станции есть предшествующий сосед (upstream neighbor) и последующий сосед 
      (downstream neighbor), определяемые ее физическими связями и направлением 
      передачи информации. 
      <P align=justify>Каждая станция в сети постоянно принимает передаваемые ей 
      предшествующим соседом кадры и анализирует их адрес назначения. Если адрес 
      назначения не совпадает с ее собственным, то она транслирует кадр своему 
      последующему соседу (рис. 32, в). Нужно отметить, что, если станция 
      захватила токен и передает свои собственные кадры, то на протяжении этого 
      периода времени она не транслирует приходящие кадры, а удаляет их из сети. 

      <P align=justify>Если же адрес кадра совпадает с адресом станции, то она 
      копирует кадр в свой внутренний буфер, проверяет его корректность (в 
      основном, по контрольной сумме), передает его поле данных для последующей 
      обработки протоколу, лежащего выше FDDI уровня (например, IP), а затем 
      передает исходный кадр по сети последующей станции (рис. 32, г). В 
      передаваемом в сеть кадре станция назначения отмечает три признака: 
      распознавания адреса, копирования кадра и отсутствия или наличия в нем 
      ошибок. 
      <P align=justify>После этого кадр продолжает путешествовать по сети, 
      транслируясь каждым узлом. Станция, являющаяся источником кадра для сети, 
      ответственна за то, чтобы удалить кадр из сети, после того, как он, 
      совершив полный оборот, вновь дойдет до нее (рис. 32, д). При этом 
      исходная станция проверяет признаки кадра, дошел ли он до станции 
      назначения и не был ли при этом поврежден. Процесс восстановления 
      информационных кадров не входит в обязанности протокола FDDI, этим должны 
      заниматься протоколы более высоких уровней. 
      <CENTER>
  <P><img src="images/2_032.gif" width="356" height="343"> 
  <P><I>Рис. 32. Обработка кадров станциями кольца FDDI</I></CENTER>
      <P align=justify>На рисунке 33 приведена структура протоколов технологии 
      FDDI в сравнении с семиуровневой моделью OSI. FDDI определяет протокол 
      физического уровня и протокол подуровня доступа к среде (MAC) канального 
      уровня. Как и многие другие технологии локальных сетей, технология FDDI 
      использует протокол 802.2 подуровня управления каналом данных (LLC), 
      определенный в стандартах IEEE 802.2 и ISO 8802.2. FDDI использует первый 
      тип процедур LLC, при котором узлы работают в дейтаграммном режиме - без 
      установления соединений и без восстановления потерянных или поврежденных 
      кадров. 
      <CENTER>
  <P><img src="images/2_033.gif" width="570" height="363"> 
  <P><I>Рис. 33. Структура протоколов технологии FDDI</I></CENTER>
      <P align=justify>Физический уровень разделен на два подуровня: независимый 
      от среды подуровень PHY (Physical), и зависящий от среды подуровень PMD 
      (Physical Media Dependent). Работу всех уровней контролирует протокол 
      управления станцией SMT (Station Management). 
      <P align=justify>Уровень PMD обеспечивает необходимые средства для 
      передачи данных от одной станции к другой по оптоволокну. В его 
      спецификации определяются: 
      <UL>
        <LI>Требования к мощности оптических сигналов и к многомодовому 
        оптоволоконному кабелю 62.5/125 мкм. 
        <LI>Требования к оптическим обходным переключателям (optical bypass 
        switches) и оптическим приемопередатчикам. 
        <LI>Параметры оптических разъемов MIC (Media Interface Connector), их 
        маркировка. 
        <LI>Длина волны в 1300 нанометров, на которой работают 
        приемопередатчики. 
        <LI>Представление сигналов в оптических волокнах в соответствии с 
        методом NRZI. </LI></UL>
      <P align=justify>Спецификация TP-PMD определяет возможность передачи 
      данных между станциями по витой паре в соответствии с методом MLT-3. 
      Спецификации уровней PMD и TP-PMD уже были рассмотрены в разделах, 
      посвященных технологии Fast Ethernet. 
      <P align=justify>Уровень PHY выполняет кодирование и декодирование данных, 
      циркулирующих между MAC-уровнем и уровнем PMD, а также обеспечивает 
      тактирование информационных сигналов. В его спецификации определяются: 
      <UL>
        <LI>кодирование информации в соответствии со схемой 4B/5B; 
        <LI>правила тактирования сигналов; 
        <LI>требования к стабильности тактовой частоты 125 МГц; 
        <LI>правила преобразования информации из параллельной формы в 
        последовательную. </LI></UL>
      <P align=justify>Уровень MAC ответственен за управление доступом к сети, а 
      также за прием и обработку кадров данных. В нем определены следующие 
      параметры: 
      <UL>
        <LI>Протокол передачи токена. 
        <LI>Правила захвата и ретрансляции токена. 
        <LI>Формирование кадра. 
        <LI>Правила генерации и распознавания адресов. 
        <LI>Правила вычисления и проверки 32-разрядной контрольной суммы. 
      </LI></UL>
      <P align=justify>Уровень SMT выполняет все функции по управлению и 
      мониторингу всех остальных уровней стека протоколов FDDI. В управлении 
      кольцом принимает участие каждый узел сети FDDI. Поэтому все узлы 
      обмениваются специальными кадрами SMT для управления сетью. В спецификации 
      SMT определено следующее: 
      <UL>
        <LI>Алгоритмы обнаружения ошибок и восстановления после сбоев. 
        <LI>Правила мониторинга работы кольца и станций. 
        <LI>Управление кольцом. 
        <LI>Процедуры инициализации кольца. </LI></UL>
      <P align=justify>Отказоустойчивость сетей FDDI обеспечивается за счет 
      управления уровнем SMT другими уровнями: с помощью уровня PHY устраняются 
      отказы сети по физическим причинам, например, из-за обрыва кабеля, а с 
      помощью уровня MAC - логические отказы сети, например, потеря нужного 
      внутреннего пути передачи токена и кадров данных между портами 
      концентратора. 
      <P align=justify>В следующей таблице представлены результаты сравнения 
      технологии FDDI с технологиями Ethernet и Token Ring. 
      <P>&nbsp; 
      <TABLE cellPadding=5 width=500 border=1>
        <TBODY>
        <TR>
          <TD><B>Характеристика </B></TD>
          <TD><B>FDDI </B></TD>
          <TD><B>Ethernet </B></TD>
          <TD><B>Token Ring</B></TD></TR>
        <TR>
          <TD>Битовая скорость </TD>
          <TD>100 Мб/с </TD>
          <TD>10 Мб/с </TD>
          <TD>16 Мб/c</TD></TR>
        <TR>
          <TD>Топология</TD>
          <TD>Двойное кольцо деревьев</TD>
          <TD>Шина/звезда</TD>
          <TD>Звезда/кольцо</TD></TR>
        <TR>
          <TD>Метод доступа </TD>
          <TD>Доля от времени оборота токена </TD>
          <TD>CSMA/CD </TD>
          <TD>Приоритетная система резервирования</TD></TR>
        <TR>
          <TD>Среда передачи данных </TD>
          <TD>Многомодовое оптоволокно, неэкранированная витая пара </TD>
          <TD>Толстый коаксиал, тонкий коаксиал, витая пара, оптоволокно </TD>
          <TD>Экранированная и неэкранированная витая пара, оптоволокно</TD></TR>
        <TR>
          <TD>Максимальная длина сети (без мостов) </TD>
          <TD>200 км (100 км на кольцо) </TD>
          <TD>2500 м </TD>
          <TD>1000 м</TD></TR>
        <TR>
          <TD>Максимальное расстояние между узлами </TD>
          <TD>2 км (-11 dB потерь между узлами) </TD>
          <TD>2500 м </TD>
          <TD>100 м</TD></TR>
        <TR>
          <TD>Максимальное количество узлов </TD>
          <TD>500 (1000 соединений) </TD>
          <TD>1024 </TD>
          <TD>260 для экранированной витой пары, 72 для неэкранированной витой 
            пары</TD></TR>
        <TR>
          <TD>Тактирование и восстановление после отказов </TD>
          <TD>Распределенная реализация тактирования и восстановления после 
            отказов </TD>
          <TD>Не определены </TD>
          <TD>Активный монитор</TD></TR></TBODY></TABLE>

<h3><a name="21_3"></a>21.3. Типы узлов и правила их соединения в сеть</h3>
      <P align=justify>Все станции в сети FDDI делятся на несколько типов по 
      следующим признакам: 
      <UL>
        <LI>конечные станции или концентраторы; 
        <LI>по варианту присоединения к первичному и вторичному кольцам; 
        <LI>по количеству MAC-узлов и, соответственно, MAC-адресов у одной 
        станции. </LI></UL>
      <P align=justify><B>Одиночное и двойное присоединение к сети</B> 
      <P align=justify>Если станция присоединена только к первичному кольцу, то 
      такой вариант называется одиночным присоединением - Single Attachment, SA 
      (рис. 34, а). Если же станция присоединена и к первичному, и ко вторичному 
      кольцам, то такой вариант называется двойным присоединением - Dual 
      Attachment, DA (рис. 34, б). 
      <CENTER>
  <P><img src="images/2_034.gif" width="310" height="406"> 
  <P><I>Рис. 34. Одиночное (SA) и двойное (DA) подключение 
      станций</I></CENTER>
      <P align=justify>Очевидно, что станция может использовать свойства 
      отказоустойчивости, обеспечиваемые наличием двух колец FDDI, только при ее 
      двойном подключении. 
      <CENTER>
  <P><img src="images/2_035.gif" width="332" height="190"> 
  <P><I>Рис. 35. Реконфигурация станций с двойным подключением при обрыве 
      кабеля</I></CENTER>
      <P align=justify>Как видно из рисунка 35, реакция станций на обрыв кабеля 
      заключается в изменении внутренних путей передачи информации между 
      отдельными компонентами станции. 
      <P align=justify><B>Количество MAC-узлов у станции </B>
      <P align=justify>Для того, чтобы иметь возможность передавать собственные 
      данные в кольцо (а не просто ретранслировать данные соседних станций), 
      станция должна иметь в своем составе хотя бы один MAC-узел, который имеет 
      свой уникальный MAC-адрес. Станции могут не иметь ни одного узла MAC, и, 
      значит, участвовать только в ретрансляции чужих кадров. Но обычно все 
      станции сети FDDI, даже концентраторы, имеют хотя бы один MAC. 
      Концентраторы используют MAC-узел для захвата и генерации служебных 
      кадров, например, кадров инициализации кольца, кадров поиска неисправности 
      в кольце и т.п. 
      <P align=justify>Станции, которые имеют один MAC-узел, называются SM 
      (Single MAC) станциями, а станции, которые имеют два MAC-узла, называются 
      DM (Dual MAC) станциями. 
      <P align=justify>Возможны следующие комбинации типов присоединения и 
      количества MAC-узлов: 
      <P align=justify>SM/SA Станция имеет один MAC-узел и присоединяется только 
      к первичному кольцу. Станция не может принимать участие в образовании 
      общего кольца из двух. 
      <P align=justify>SM/DA Станция имеет один MAC-узел и присоединяется сразу 
      к первичному и вторичному кольцам. В нормальном режиме она может принимать 
      данные только по первичному кольцу, используя второе для отказоустойчивой 
      работы. 
      <P align=justify>DM/DA Станция имеет два MAC-узла и присоединена к двум 
      кольцам. Может (потенциально) принимать данные одновременно по двум 
      кольцам (полнодуплексный режим), а при отказах участвовать в 
      реконфигурации колец. 
      <P align=justify>DM/SA Станция имеет два MAC-узла, но присоединена только 
      к первичному кольцу. Запрещенная комбинация для конечной станции, 
      специальный случай работы концентратора. 
      <P align=justify>В зависимости от того, является ли станция концентратором 
      или конечной станцией, приняты следующие обозначения в зависимости от типа 
      их подключения: 
      <UL>
        <LI>SAS (Single Attachment Station) - конечная станция с одиночным 
        подключением. 
        <LI>DAS (Dual Attachment Station) - конечная станция с двойным 
        подключением. 
        <LI>SAC (Single Attachment Concentrator) - концентратор с одиночным 
        подключением. 
        <LI>DAC (Dual Attachment Concentrator) - концентратор с двойным 
        подключением. </LI></UL>
      <P align=justify><B>Типы портов станций и концентраторов FDDI и правила их 
      соединения</B> 
      <P align=justify>В стандарте FDDI описаны четыре типа портов, которые 
      отличаются своим назначением и возможностями соединения друг с другом для 
      образования корректных конфигураций сетей. 
      <P>&nbsp; 
      <TABLE cellPadding=5 width=500 border=1>
        <TBODY>
        <TR>
          <TD><B>Тип порта </B></TD>
          <TD><B>Подключение </B></TD>
          <TD><B>Назначение</B></TD></TR>
        <TR>
          <TD>A </TD>
          <TD>PI/SO - (Primary In/Secondary Out)<BR>Вход первичного кольца/ 
            Выход вторичного кольца </TD>
          <TD>Соединяет устройства с двойным подключением с магистральными 
            кольцами</TD></TR>
        <TR>
          <TD>B </TD>
          <TD>PO/SI - (Primary Out/Secondary In)<BR>Выход первичного 
            кольца/Вход вторичного кольца </TD>
          <TD>Соединяет устройства с двойным подключением с магистральными 
            кольцами</TD></TR>
        <TR>
          <TD>M </TD>
          <TD>Master - PI/PO<BR>Вход первичного кольца/Выход первичного кольца 
          </TD>
          <TD>Порт концентратора, который соединяет его с устройствами с 
            одиночным подключением; использует только первичное кольцо</TD></TR>
        <TR>
          <TD>S </TD>
          <TD>Slave - PI/PO<BR>Вход первичного кольца/Выход первичного кольца 
          </TD>
          <TD>Соединяет устройство с одиночным подключением к концентратору; 
            использует только первичное кольцо</TD></TR></TBODY></TABLE>
      <P align=justify>На рисунке 36 показано типичное использование портов 
      разных типов для подключения станций SAS и DAS к концентратору DAC. 
      <CENTER>
  <P><img src="images/2_036.gif" width="387" height="359"> 
  <P><I>Рис. 36. Использование портов различных типов</I></CENTER>
      <P align=justify>Соединение портов S - S является допустимым, так как 
      создает изолированное первичное кольцо, соединяющее только две станции, но 
      обычно неиспользуемым. 
      <P align=justify>Соединение портов M - M является запрещенным, а 
      соединения A-A, B-B, A-S, S-A, B-S, S-B - нежелательными, так как создают 
      неэффективные комбинации колец. 
      <P align=justify><B>Соединение Dual Homing</B> 
      <P align=justify>Соединения типа A-M и B-M соответствуют случаю, так 
      называемого, Dual Homing подключения, когда устройство с возможностью 
      двойного подключения, то есть с портами A и B, использует их для двух 
      подключений к первичному кольцу через порты M другого устройства. 
      <P align=justify>Такое подключение показано на рисунке 37. 
      <P align=justify>На нем два концентратора, DAC4 и DAC5, подключены к 
      концентраторам DAC1, DAC2 и DAC3 по схеме Dual Homing. 
      <P align=justify>Концентраторы DAC1, DAC2 и DAC3 подключены обычным 
      способом к обеим кольцам, образуя корневую магистраль сети FDDI. Обычно 
      такие концентраторы называют в англоязычной литературе rooted 
      concentrators. 
      <P align=justify>Концентраторы DAC4 и DAC5 подключены по древовидной 
      схеме. Ее можно было бы образовать и с помощью концентраторов SAC4 и SAC5, 
      которые бы в этом случае подключались бы к М-порту корневых концентраторов 
      с помощью порта S. 
      <P align=justify>Подключение DAC-концентраторов по древовидной схеме, но с 
      использованием Dual Homing, позволяет повысить отказоустойчивость сети, и 
      сохранить преимущества древовидной многоуровневой структуры. 
      <CENTER>
  <P><img src="images/2_037.gif" width="420" height="321"> 
  <P><I>Рис. 37. Соединение Dual Homing</I></CENTER>
      <P align=justify>Концентратор DAC4 подключен по классической схеме Dual 
      Homing. Эта схема рассчитана на наличие у такого концентратора только 
      одного MAC-узла. При подключении портов A и B концентратора DAC4 к портам 
      М концентратора DAC1 между этими портами устанавливается физическое 
      соединение, которое постоянно контролируется физическим уровнем PHY. 
      Однако, в активное состояние по отношению к потоку кадров по сети 
      переводится только порт B, а порт A остается в резервном логическом 
      состоянии. Предпочтение, отдаваемое по умолчанию порту В, определено в 
      стандарте FDDI. 
      <P align=justify>При некорректной работе физического соединения по порту B 
      концентратор DAC4 переводит его в резервное состояние, а активным 
      становится порт А. После этого порт В постоянно проверяет физическое 
      состояние его линии связи, и, если оно восстановилось, то он снова 
      становится активным. 
      <P align=justify>Концентратор DAC5 также включен в есть по схеме Dual 
      Homing, но с более полными функциональными возможностями по контролю 
      соединения резервного порта А. Концентратор DAC5 имеет два узла MAC, 
      поэтому не только порт В работает в активном режиме в первичном кольце, 
      передавая кадры первичному MAC-узлу от порта М концентратора DAC3, но и 
      порт А также находится в активном состоянии, принимая кадры от того же 
      первичного кольца, но от порта М концентратора DAC2. Это позволяет 
      вторичному MAC-узлу постоянно отслеживать логическое состояние резервной 
      связи. 
      <P align=justify>Необходимо заметить, что устройства, поддерживающие режим 
      Dual Homing, могут быть реализованы несколькими различными способами, 
      поэтому может наблюдаться несовместимость этих режимов у различных 
      производителей. 
      <P align=justify><B>Присоединение станции к "блуждающему" MAC-узлу</B> 
      <P align=justify>Когда новая станция включается в сеть FDDI, то сеть на 
      время приостанавливает свою работу, проходя через процесс инициализации 
      кольца, в течение которого между всеми станциями согласуются основные 
      параметры кольца, самым важным из которых является номинальное время 
      оборота токена по кольцу. Этой процедуры в некоторых случаях можно 
      избежать. Примером такого случая является подключение новой станции SAS к 
      порту М концентратора с так называемым "блуждающим" узлом MAC (Roving 
      MAC), который также называют локальным MAC-узлом. 
      <P align=justify>Пример такого подключения показан на рисунке 38. 
      <CENTER>
  <P><img src="images/2_038.gif" width="351" height="296"> 
  <P><I>Рис. 38. Присоединение станции к "блуждающему" MAC-узлу</I></CENTER>
      <P align=justify>Концентратор DM/DAC1 имеет два MAC-узла: один участвует в 
      нормальной работе первичного кольца, а второй, локальный, присоединен к 
      пути, соединяющему порт M со станцией SAS3. Этот путь образует 
      изолированное кольцо и используется для локальной проверки 
      работоспособности и параметров станции SAS3. Если он работоспособен и его 
      параметры не требуют реинициализации основной сети, то станция SAS3 
      включается в работу первичного кольца "плавно" (smooth-insertion). 
      <P align=justify><B>Подключение станций с помощью оптических обходных 
      переключателей (Optical Bypass Switch)</B> 
      <P align=justify>Факт отключения питания станции с одиночным подключением 
      будет сразу же замечен средствами физического уровня, обслуживающими 
      соответствующий М-порт концентратора, и этот порт по команде уровня SMT 
      концентратора будет обойден по внутреннему пути прохождения данных через 
      концентратор. На дальнейшую отказоустойчивость сети этот факт никакого 
      влияния не окажет (рис. 39). 
      <CENTER>
  <P><img src="images/2_039.gif" width="315" height="413"> 
  <P><I>Рис. 39. Оптический обходной переключатель (Optical Bypass 
      Switch)</I></CENTER>
      <P align=justify>Если же отключить питание у станции DAS или концентратора 
      DAC, то сеть, хотя и продолжит работу, перейдя в состояние Wrap, но запас 
      отказоустойчивости будет утерян, что нежелательно. Поэтому для устройств с 
      двойным подключением рекомендуется использовать оптические обходные 
      переключатели - Optical Bypass Switch, которые позволяют закоротить 
      входные и выходные оптические волокна и обойти станцию в случае ее 
      выключения. Оптический обходной переключатель питается от станции и 
      состоит в простейшем случае из отражающих зеркал или подвижного 
      оптоволокна. При отключенном питании такой переключатель обходит станцию, 
      а при включении ее питания соединяет входы портов А и В с внутренними 
      схемами PHY станции. 
       
<h3><a name="21_4"></a>21.4. Функции МАС-уровня и форматы кадров</h3>
      <P align=justify><B>Функции МАС-уровня</B> 
      <P align=justify>В соответствии со стандартами IEEE 802 канальный уровень 
      в локальных сетях состоит из двух подуровней - LLC и МАС. Стандарт FDDI не 
      вводит свое определение подуровня LLC, а использует его сервисы, описанные 
      в документе IEEE 802.2 LLC. 
      <P align=justify>Подуровень МАС выполняет в технологии FDDI следующие 
      функции: 
      <UL>
        <LI>Поддерживает сервисы для подуровня LLC. 
        <LI>Формирует кадр определенного формата. 
        <LI>Управляет процедурой передачи токена. 
        <LI>Управляет доступом станции к среде. 
        <LI>Адресует станции в сети. 
        <LI>Копирует кадры, предназначенные для данной станции, в буфер и 
        уведомляет подуровень LLC и блок управления станцией SMT о прибытии 
        кадра. 
        <LI>Генерирует контрольную последовательность кадра (CRC) и проверяет ее 
        у всех кадров, циркулирующих по кольцу. 
        <LI>Удаляет из кольца все кадры, которые сгенерировала данная станция. 
        <LI>Управляет таймерами, которые контролируют логическую работу кольца - 
        таймером удержания токена, таймером оборота токена и т.д. 
        <LI>Ведет ряд счетчиков событий, что помогает обнаружить и локализовать 
        неисправности. 
        <LI>Определяет механизмы, используемые кольцом для реакции на ошибочные 
        ситуации - повреждение кадра, потерю кадра, потерю токена и т.д. 
</LI></UL>
      <P align=justify>В данном разделе для иллюстрации работы МАС-уровня будет 
      использоваться станция с двойным подключением и одним блоком МАС, то есть 
      станция DA/SM. Ее внутренняя структура показана на рисунке 40. 
      <CENTER>
  <P><img src="images/2_040.gif" width="326" height="298"> 
  <P><I>Рис. 40. Внутренняя структура станции с двойным подключением и одним 
      блоком МАС</I></CENTER>
      <P align=justify>В каждом блоке МАС параллельно работают два процесса: 
      процесс передачи символов - <I>MAC Transmit </I>и процесс приема символов 
      - <I>MAC Receive.</I> За счет этого МАС может одновременно передавать 
      символы одного кадра и принимать символы другого кадра. 
      <P align=justify><B>Форматы кадра и токена</B> 
      <P align=justify>По сети FDDI информация передается в форме двух блоков 
      данных: кадра и токена. Формат кадра FDDI представлен на рисунке 41. 
      <CENTER>
  <P><img src="images/2_041.gif" width="390" height="119"> 
  <P><I>Рис. 41. Формат кадра FDDI</I></CENTER>
      <P align=justify>Рассмотрим назначение полей кадра: 
      <UL>
        <LI>Преамбула (Preamble, PA). Любой кадр должен предваряться преамбулой, 
        состоящей как минимум из 16 символов Idle (I). Эта последовательность 
        предназначена для вхождения в синхронизм генератора RCRCLK, 
        обеспечивающего прием последующих символов кадра. 
        <LI>Начальный ограничитель (Starting Delimiter, SD). Состоит из пары 
        символов JK, которые позволяют однозначно определить границы для 
        остальных символов кадра. 
        <LI>Поле управления (Frame Control, FC). Идентифицирует тип кадра и 
        детали работы с ним. Имеет 8-ми битовый формат и передается с помощью 
        двух символов. Состоит из подполей, обозначаемых как CLFFZZZZ, которые 
        имеют следующее назначение: 
        <UL>
          <LI>С - говорит о том, какой тип трафика переносит кадр - синхронный 
          (значение 1) или асинхронный (значение 0). 
          <LI>L - определяет длину адреса кадра, который может состоять из 2-х 
          байт или из 6-ти байт. 
          <LI>FF - тип кадра, может иметь значение 01 для обозначения кадра LLC 
          (пользовательские данные) или 00 для обозначения служебного кадра 
          MAC-уровня. Служебными кадрами МАС-уровня являются кадры трех типов - 
          кадры процедуры инициализации кольца Claim Frame, кадры процедуры 
          сигнализации о логической неисправности Beacon Frame и кадры процедуры 
          управления кольцом SMT Frame. 
          <LI>ZZZZ - детализирует тип кадра.</LI></UL>
        <LI>Адрес назначения (Destination Address, DA) - идентифицирует станцию 
        (уникальный адрес) или группу станций (групповой адрес), которой(ым) 
        предназначен кадр. Может состоять из 2-х или 6-ти байт. 
        <LI>Адрес источника (Source Address, SA) - идентифицирует станцию, 
        сгенерировавшую данный кадр. Поле должно быть той же длины, что и поле 
        адреса назначения. 
        <LI>Информация (INFO) - содержит информацию, относящуюся к операции, 
        указанной в поле управления. Поле может иметь длину от 0 до 4478 байт 
        (от 0 до 8956 символов). Стандарт FDDI допускает размещение в этом поле 
        маршрутной информации алгоритма Source Routing, определенной в стандарте 
        802.5. При этом в два старших бита поля адреса источника SA помещается 
        комбинация 102 - групповой адрес, комбинация, не имеющая смысла для 
        адреса источника, а обозначающая присутствие маршрутной информации в 
        поле данных. 
        <LI>Контрольная последовательность (Frame Check Sequence, FCS) - 
        содержит 32-х битную последовательность, вычисленную по стандартному 
        методу CRC-32, принятому и для других протоколов IEEE 802. Контрольная 
        последовательность охватывает поля FC, DA, SA, INFO и FCS. 
        <LI>Конечный ограничитель (Ending Delimiter, ED) - содержит единственный 
        символ Terminate (T), обозначающий границу кадра. Однако за ним 
        располагаются еще признаки статуса кадра. 
        <LI>Статус кадра (Frame Status, FS). Первые три признака в поле статуса 
        должны быть индикаторами ошибки (Error, E), распознавания адреса 
        (Address recognized, A) и копирования кадра (Frame Copied, C). Каждый из 
        этих индикаторов кодируется одним символом, причем нулевое состояние 
        индикатора обозначается символом Reset (R), а единичное - Set (S). 
        Стандарт позволяет производителям оборудования добавлять свои индикаторы 
        после трех обязательных. </LI></UL>
      <P align=justify>На рисунке 42 показан формат токена. 
      <CENTER>
  <P><img src="images/2_042.gif" width="436" height="55"> 
  <P><I>Рис. 42. Формат токена</I></CENTER>
      <P align=justify>Токен состоит по существу из одного значащего поля - поля 
      управления, которое содержит в этом случае 1 в поле С и 0000 в поле ZZZZ. 
      <P align=justify><B>Операции МАС-уровня</B> 
      <P align=justify>С помощью операций МАС-уровня станции получают доступ к 
      кольцу и передают свои кадры данных. Цикл передачи кадра от одной станции 
      к другой состоит из нескольких этапов: захвата токена станцией, которой 
      необходимо передать кадр, передачей одного или нескольких кадров данных, 
      освобождением токена передающей станцией, ретрансляцией кадра 
      промежуточными станциями, распознаванием и копированием кадра 
      станцией-получателем и удалением кадра из сети станцией-отправителем. 
      <P align=justify>Рассмотрим эти операции. 
      <P align=justify><I>Захват токена.</I> Если станция имеет право захватить 
      токен, то она после ретрансляции на выходной порт символов PA и SD токена, 
      удаляет из кольца символ FC, по которому она распознала токен, а также 
      конечный ограничитель ED. Затем она передает вслед за уже переданным 
      символом SD символы своего кадра, таким образом, формируя его из начальных 
      символов токена (рис. 43). 
      <P align=justify><I>Передача кадра.</I> После удаления полей FC и ED 
      токена станция начинает передавать символы кадров, которые ей предоставил 
      для передачи уровень LLC. Станция может передавать кадры до тех пор, пока 
      не истечет время удержания токена. 
      <P align=justify>Для сетей FDDI предусмотрена передача кадров двух типов 
      трафика - синхронного и асинхронного. 
      <P align=justify><I>Синхронный трафик </I>предназначен для приложений, 
      которые требуют предоставления им гарантированной пропускной способности 
      для передачи голоса, видеоизображений, управления процессами и других 
      случаев работы в реальном времени. Для такого трафика каждой станции 
      предоставляется фиксированная часть пропускной способности кольца FDDI, 
      поэтому станция имеет право передавать кадры синхронного трафика всегда, 
      когда она получает токен от предыдущей станции. 
      <CENTER>
  <P><img src="images/2_043.gif" width="376" height="298"> 
  <P><I>Рис. 43. Захват токена</I></CENTER>
      <P align=justify><I>Асинхронный трафик </I>- это обычный трафик локальных 
      сетей, не предъявляющий высоких требований к задержкам обслуживания. 
      Станция может передавать асинхронные кадры только в том случае, если при 
      последнем обороте токена по кольцу для этого осталась какая-либо часть 
      неизрасходованной пропускной способности. Интервал времени, в течение 
      которого станция может передавать асинхронные кадры, называется временем 
      удержания токена <I>(Token Holding Time, THT).</I> Каждая станция 
      самостоятельно вычисляет текущее значение этого параметра по алгоритму, 
      рассмотренному ниже. 
      <P align=justify>Рисунок 44 иллюстрирует процесс передачи кадра. 
      <CENTER>
  <P><img src="images/2_044.gif" width="424" height="322"> 
  <P><I>Рис. 44. Передача кадра</I></CENTER>
      <P align=justify>В ходе передачи символов собственного кадра станция 
      удаляет из кольца все поступающие от предыдущей станции символы. Такой 
      процесс называется МАС-заменой (MAC Overwriting). Первоначальный источник 
      удаляемого из сети кадра не имеет значения - это может быть и данный 
      МАС-узел, который ранее поместил этот кадр в кольцо, либо другой МАС-узел. 
      Процесс удаления кадров во время передачи никогда не приводит к удалению 
      еще необработанных кадров: если сеть работает корректно, то удаляются 
      только усеченные кадры, которые образуются либо при захвате токена (этот 
      вариант уже рассмотрен), либо при удалении своего кадра 
      станцией-источником (этот вариант будет рассмотрен ниже). В любом случае, 
      усеченный кадр (remnant frame) - это кадр, у которого есть начальный 
      ограничитель, но отсутствует конечный ограничитель, а вместо него и, может 
      быть, еще некоторых полей вставлены символы простоя Idle. 
      <P align=justify>В случае, если удаляемые символы принадлежат кадру, ранее 
      сгенерированному данным МАС-узлом, то одновременно с удалением кадра из 
      кольца проверяются признаки статуса кадра из поля FS - распознавания 
      адреса, копирования и ошибки. Если признак ошибки установлен, то 
      МАС-уровень не занимается повторной передачей кадра, оставляя это уровню 
      LLC или другим верхним уровням коммуникационного стека протоколов. 
      <P align=justify>Станция прекращает передачу кадров в двух случаях: либо 
      при истечении времени удержания токена THT, либо при передаче всех 
      имеющихся у нее кадров до истечения этого срока. После передачи последнего 
      своего кадра станция формирует токен и передает его следующей станции. 
      <P align=justify><I>Повторение кадра.</I> Если кадр не адресуется данному 
      МАС-узлу, то последний должен просто повторить каждый символ кадра на 
      выходном порту. Каждый МАС-узел должен подсчитывать количество полученных 
      им полных кадров (усеченные не включаются в подсчет). Каждая станция 
      проверяет повторяемый кадр на наличие ошибок с помощью контрольной 
      последовательности. Если ошибка обнаружена, а признак ошибки в поле FS не 
      установлен, то МАС-узел устанавливает этот признак в кадре, а также 
      наращивает счетчик ошибочных кадров, распознанных данным МАС-узлом. 
      <P align=justify><I>Обработка кадра станцией назначения.</I> Станция 
      назначения, распознав свой адрес в поле DA, начинает копировать символы 
      кадра во внутренний буфер одновременно с повторением их на выходном порту. 
      При этом станция назначения устанавливает признак распознавания адреса. 
      Если же кадр скопирован во внутренний буфер, то устанавливается и признак 
      копирования (невыполнение копирования может произойти, например, из-за 
      переполнения внутреннего буфера). Устанавливается также и признак ошибки, 
      если ее обнаружила проверка по контрольной последовательности. 
      <P align=justify><I>Удаление кадра из кольца.</I> Каждый МАС-узел 
      ответственен за удаление из кольца кадров, которые он ранее в него 
      поместил. Этот процесс известен под названием <I>Frame Stripping.</I> Если 
      МАС-узел при получении своего кадра занят передачей следующих кадров, то 
      он удаляет все символы вернувшегося по кольцу кадра. Если же он уже 
      освободил токен, то он повторяет на выходе несколько полей этого кадра 
      прежде, чем распознает свой адрес в поле SA. В этом случае в кольце 
      возникает усеченный кадр, у которого после поля SA следуют символы Idle и 
      отсутствует конечный ограничитель. Этот усеченный кадр будет удален из 
      кольца какой-нибудь станцией, принявшей его в состоянии собственной 
      передачи. 
       
<h3><a name="21_5"></a>21.5. Инициализация кольца</h3>
      <P align=justify>Процедура инициализации кольца, известная под названием 
      <I>Claim Token </I>(это название в свободном переводе можно может 
      интерпретироваться как "соревнование претендентов на генерацию токена"), 
      выполняется для того, чтобы все станции кольца убедились в его 
      потенциальной работоспособности, а также пришли к соглашению о значении 
      параметра T_Opr - максимально допустимому времени оборота токена по 
      кольцу, на основании которого все станции вычисляют время удержания токена 
      THT. 
      <P align=justify>Процедура Claim Token выполняется в нескольких ситуациях: 

      <UL>
        <LI>При включении новой станции в кольцо и при выходе станции из кольца. 

        <LI>При обнаружении какой-либо станцией факта утери токена. Токен 
        считается утерянным, если станция не наблюдает его в течение двух 
        периодов времени максимального оборота токена T_Opr. 
        <LI>При обнаружении длительного отсутствия активности в кольце, когда 
        станция в течение определенного времени не наблюдает проходящих через 
        нее кадров данных. 
        <LI>По команде от блока управления станцией SMT. </LI></UL>
      <P align=justify>Для выполнения процедуры инициализации каждая станция 
      сети должна знать о своих требованиях к максимальному времени оборота 
      токена по кольцу. Эти требования содержатся в параметре, называемом 
      "требуемое время оборота токена" - <I>TTRT (Target Token Rotation 
      Time)</I>. Параметр TTRT отражает степень потребности станции в пропускной 
      способности кольца - чем меньше время TTRT, тем чаще станция желает 
      получать токен для передачи своих кадров. Процедура инициализации 
      позволяет станциям узнать о требованиях ко времени оборота токена других 
      станций и выбрать минимальное время в качестве общего параметра T_Opr, на 
      основании которого в дальнейшем будет распределяться пропускная 
      способность кольца. Параметр TTRT должен находиться в пределах от 4 мс до 
      165 мс и может изменяться администратором сети. 
      <P align=justify>Для проведения процедуры инициализации станции 
      обмениваются служебными кадрами МАС-уровня - кадрами Claim. Эти кадры 
      имеют в поле управления значение 1L00 0011, поле адреса назначения 
      содержит адрес источника (DA = SA), а в поле информации содержится 4-х 
      байтовое значение запрашиваемого времени оборота токена T_Req. 
      <P align=justify>Если какая-либо станция решает начать процесс 
      инициализации кольца по своей инициативе, то она формирует кадр Claim 
      Token со своим значением требуемого времени оборота токена TTRT, то есть 
      присваивает полю T_Req свое значение TTRT. Захвата токена для отправки 
      кадра Claim не требуется. Любая другая станция, получив кадр Claim Token, 
      начинает выполнять процесс Claim Token. При этом станции устанавливают 
      признак нахождения кольца в работоспособном состоянии Ring_Operational в 
      состояние False, что означает отмену нормальных операций по передаче 
      токена и кадров данных. В этом состоянии станции обмениваются только 
      служебными кадрами Claim. 
      <P align=justify>Для выполнения процедуры инициализации каждая станция 
      поддерживает таймер текущего времени оборота токена TRT (Token Rotation 
      Timer), который используется также и в дальнейшем при работе кольца в 
      нормальном режиме. Для упрощения изложения будем считать, что этот таймер, 
      как и другие таймеры станции, инициализируется нулевым значением и затем 
      наращивает свое значение до определенной величины, называемой порогом 
      истечения таймера. (В реальном кольце FDDI все таймеры работают в двоичном 
      дополнительном коде). 
      <P align=justify>Таймер TRT запускается каждой станцией при обнаружении 
      момента начала процедуры Claim Token. В качестве предельного значения 
      таймера выбирается максимально допустимое время оборота токена, то есть 
      165 мс. Истечение таймера TRT до завершения процедуры означает ее 
      неудачное окончание - кольцо не удалось инициализировать. В случае неудачи 
      процесса Claim Token запускается процессы Beacon и Trace, с помощью 
      которых станции кольца пытаются выявить некорректно работающую часть 
      кольца и отключить ее от сети. 
      <P align=justify>Во время выполнения процесса Claim Token каждая станция 
      сначала может отправить по кольцу кадр Claim со значением T_Req, равным 
      значению ее параметра TTRT. При этом она устанавливает значение T_Opr, 
      равное значению TTRT. Рассмотрим пример инициализируемого кольца, 
      приведенный на рисунке 45. 
      <P align=justify>В некоторый момент времени все станции передали по кольцу 
      свои предложения о значении максимального времени оборота токена: 72 мс, 
      37 мс, 51 мс и 65 мс. Станция, приняв кадр Claim от предыдущей станции, 
      обязана сравнить значение T_Req, указанное в кадре со значением TTRT 
      своего предложения. Если другая станция просит установить время оборота 
      токена меньше, чем данная (то есть T_Req &lt; TTRT), то данная станция 
      перестает генерировать собственные кадры Claim и начинает повторять чужие 
      кадры Claim, так как видит, что в кольце есть более требовательные 
      станции. Одновременно станция фиксирует в своей переменной T_Opr 
      минимальное значение T_Req, которое ей встретилось в чужих кадрах Claim. 
      Если же пришедший кадр имеет значение T_Req больше, чем собственное 
      значение TTRT, то он удаляется из кольца. 
      <CENTER>
  <P><img src="images/2_045.gif" width="390" height="294"> 
  <P><I>Рис. 45. Процесс инициализации кольца</I></CENTER>
      <P align=justify>Процесс Claim завершается для станции в том случае, если 
      она получает кадр Claim со своим адресом назначения. Это означает, что 
      данная станция является победителем состязательного процесса и ее значение 
      TTRT оказалось минимальным. В рассматриваемом примере это станция B со 
      значением TTRT, равным 37 мс. Другие станции кольца не смогут получить 
      свой кадр Claim, так как он не сможет пройти через станцию B. При равных 
      значениях параметра TTRT преимущество отдается станции с большим значением 
      МАС-адреса. 
      <P align=justify>После того, как станция обнаруживает, что она оказалась 
      победителем процесса Claim Token, она должна сформировать токен и 
      отправить его по кольцу. Первый оборот токена - служебный, так как за 
      время этого оборота станции кольца узнают, что процесс Claim Token успешно 
      завершился. При этом они устанавливают признак Ring_Operational в 
      состояние True, означающее начало нормальной работы кольца. При следующем 
      проходе токена его можно будет использовать для захвата и передачи кадров 
      данных. 
      <P align=justify>Если же у какой-либо станции во время выполнения процедур 
      инициализации таймер TRT истек, а токен так и не появился на входе 
      станции, то станция начинает процесс Beacon. 
      <P align=justify>После нормального завершения процесса инициализации у 
      всех станций кольца устанавливается одинаковое значение переменной T_Opr. 
       
<h3><a name="21_6"></a>21.6. Управление доступом к кольцу</h3>
      <P align=justify>Управление доступом к кольцу FDDI распределено между его 
      станциями. Каждая станция при прохождении через нее токена самостоятельно 
      решает, может она его захватить или нет, а если да, то на какое время. 
      <P align=justify>Если у станции имеются для передачи синхронные кадры, то 
      она всегда может захватить токен на фиксированное время, выделенное ей 
      администратором. 
      <P align=justify>Если же у станции имеются для передачи асинхронные кадры, 
      то условия захвата определяются следующим образом. 
      <P align=justify>Станция ведет уже упомянутый таймер текущего времени 
      оборота токена TRT, а также счетчик количества опозданий токена Late_Ct. 
      Время истечения таймера TRT равно значению максимального времени оборота 
      токена T_Opr, выбранному станциями при инициализации кольца. 
      <P align=justify>Счетчик Late_Ct всегда сбрасывается в нуль, когда токен 
      проходит через станцию. Если же токен опаздывает, то таймер достигает 
      значения T_Opr раньше очередного прибытия токена. При этом таймер 
      обнуляется и начинает отсчет времени заново, а счетчик Late_Ct 
      наращивается на единицу, фиксируя факт опоздания токена. При прибытии 
      опоздавшего токена (при этом Late_Ct = 1) таймер TRT не сбрасывается в 
      нуль, а продолжает считать, накапливая время опоздания токена. Если же 
      токен прибыл раньше, чем истек интервал T_Opr у таймера TRT, то таймер 
      сбрасывается в момент прибытия токена. 
      <P align=justify>На рисунке 46 приведены различные случаи прибытия токена. 
      Значение максимального времени оборота токена для примера, приведенного на 
      этом рисунке, равно 30 мс. 
      <CENTER>
  <P><img src="images/2_046.gif" width="436" height="305"> 
  <P><I>Рис. 46. Поведение таймера времени текущего оборота токена TRT и 
      счетчика опозданий токена Late_Ct</I></CENTER>
      <P align=justify>Приведенный пример иллюстрирует следующие события: 
      <P align=justify><B>Момент А:</B> Токен прибыл вовремя, так как таймер TRT 
      не достиг порога T_Opr. Таймер TRT перезапускается и начинает считать 
      заново. 
      <P align=justify><B>Момент В:</B> Токен прибыл вовремя. Таймер 
      перезапускается. 
      <P align=justify><B>Момент С:</B> Таймер истек раньше, чем токен прибыл на 
      станцию. Таймер TRT перезапускается, а счетчик Late_Ct наращивается на 
      единицу. 
      <P align=justify><B>Момент D:</B> Токен наконец прибыл, но он опоздал - 
      это отмечает счетчик Late_Ct, равный 1. Счетчик сбрасывается в нуль, но 
      таймер не перезапускается, так как при приходе токена счетчик не был равен 
      нулю. 
      <P align=justify><B>Момент Е:</B> Токен прибыл на станцию. Так как он 
      прибыл до истечения таймера и при нулевом значении счетчика Late_Ct, то 
      считается, что он прибыл вовремя. Таймер перезапускается. 
      <P align=justify>Теперь рассмотрим, каким образом значения таймера TRT и 
      счетчика Late_Ct используются при выяснении возможности захвата токена и 
      времени его удержания. 
      <P align=justify>Станция может захватывать токен только в том случае, 
      когда он прибывает вовремя - то есть в момент его прибытия счетчик Late_Ct 
      равен нулю. 
      <P align=justify>Время удержания токена управляется таймером удержания 
      токена <I>THT (Token Holding Timer).</I> Если станция имеет в буфере кадры 
      для передачи в момент прибытия токена и токен прибыл вовремя, то станция 
      захватывает его и удерживает в течение периода (T_Opr - TRT), где TRT - 
      значение таймера TRT в момент прихода токена. Для отслеживания 
      разрешенного времени удержания токена в момент захвата токена значение TRT 
      присваивается таймеру THT, а затем таймер TRT обнуляется и 
      перезапускается. Таймер THT считает до границы T_Opr, после чего 
      считается, что время удержания токена исчерпано. Станция перестает 
      передавать кадры данных и передает токен. 
      <P align=justify>Описанный алгоритм позволяет адаптивно распределять 
      пропускную способность кольца между станциями, а точнее - ту ее часть, 
      которая осталась после распределения между синхронным трафиком станций. 
      <P align=justify>Пример работы алгоритма выделения времени для передачи 
      асинхронного трафика приведен на рисунке 47. Как и в предыдущем примере, 
      время максимального оборота токена равно 30 мс. 
      <CENTER>
  <P><img src="images/2_047.gif" width="474" height="282"> 
  <P><I>Рис. 47. Выделение времени для асинхронного трафика</I></CENTER>
      <P align=justify>Рассмотрим события, иллюстрируемые примером: 
      <P align=justify><B>Момент А:</B> Токен прибыл вовремя, так как таймер TRT 
      не достиг порога T_Opr. Таймер TRT перезапускается и начинает считать 
      заново. Станция не имеет в это время асинхронных кадров, поэтому просто 
      передает токен соседу. 
      <P align=justify><B>Момент В:</B> Токен прибыл вовремя. Станция имеет к 
      этому моменту асинхронные кадры для передачи. Таймеру THT присваивается 
      значение таймера TRT (16), и он начинает считать до значения T_Opr (30). 
      Таймер TRT перезапускается. Станция начинает передавать кадры. Она может 
      это делать в течение 14 мс. Если она закончит передачу имеющихся кадров 
      раньше, то она обязана немедленно освободить токен. 
      <P align=justify><B>Момент С:</B> Таймер THT истек, и станция должна 
      прекратить передачу асинхронных кадров. Станция завершает передачу 
      текущего кадра и передает токен соседней станции. Счетчик TRT при этом 
      продолжает работать. 
      <P align=justify><B>Момент D</B>: Таймер TRT истекает раньше очередного 
      прибытия токена. Таймер перезапускается, а счетчик Late_Ct наращивается на 
      1. 
      <P align=justify><B>Момент Е:</B> Токен прибывает, но он опоздал, так как 
      Late_Ct имеет значение 1. Станция не может захватить токен при значении 
      Late_Ct, отличном от нуля.Токен передается соседней станции. Счетчик 
      Late_Ct обнуляется, а таймер TRT не перезапускается. 
      <P align=justify><B>Момент F: </B>Токен прибывает на станцию. Так как 
      таймер TRT еще не истек, а значение Late_Ct равно 0, то токен прибыл 
      вовремя. Таймер THT инициализируется значением таймера TRT (22) и начинает 
      считать до границы T_Opr. TRT перезапускается.Станция может передавать 
      кадры в течение 8 мс. 
      <P align=justify><B>Момент G:</B> Таймер THT истекает, и передача 
      асинхронных кадров прекращается. Станция передает токен соседней станции. 
      <P align=justify>В стандарте FDDI определено также еще два механизма 
      управления доступом к кольцу. Во-первых, в токене можно задавать уровень 
      приоритета токена, а для каждого уровня приоритета задается свое время 
      порога, до которого считает таймер удержания токена THT. Во-вторых, 
      определена особая форма токена - сдерживающий токен (restricted token), с 
      помощью которого две станции могут монопольно некоторое время обмениваться 
      данными по кольцу. 
      <P align=justify>Если таймер TRT истечет при значении Late_Ct, равном 1, 
      то такое событие считается потерей токена и порождает выполнение процесса 
      реинициализации кольца Claim Token. 
       
<h3><a name="21_7"></a>21.7. Спецификация зависящего от среды физического подуровня 
  PMD</h3>
      <P align=justify><B>Структура физического соединения</B> 
      <P align=justify>Рассмотрим физический подуровень PMD (Physical Media 
      Dependent layer), определенный в стандарте FDDI для оптоволокна - Fiber 
      PMD. 
      <P align=justify>Эта спецификация определяет аппаратные компоненты для 
      создания физических соединений между станциями: оптические передатчики, 
      оптические приемники, параметры кабеля, оптические разъемы. Для каждого из 
      этих элементов указываются конструктивные и оптические параметры, 
      позволяющие станциям устойчиво взаимодействовать на определенных 
      расстояниях. 
      <P align=justify>Физическое соединение - основной строительный блок сети 
      FDDI. Типичная структура физического соединения представлена на рисунке 
      48. 
      <P align=justify>Каждое физическое соединение состоит из двух физических 
      связей - первичной и вторичной. Эти связи являются односторонними - данные 
      передаются от передатчика одного устройства PHY к приемнику другого 
      устройства PHY. 
      <CENTER>
  <P><img src="images/2_048.gif" width="398" height="223"> 
  <P><I>Рис. 48. Физическое соединение сети FDDI</I></CENTER>
      <P align=justify><B>Требования к мощности оптических сигналов </B>
      <P align=justify>В стандарте Fiber PMD в явном виде не определены 
      предельные расстояния между парой взаимодействующих устройств по одному 
      физическому соединению. 
      <P align=justify>Вместо этого в стандарте определен максимальный уровень 
      потерь мощности оптического сигнала между двумя станциями, 
      взаимодействующими по одной физической связи. Этот уровень равен -11 dB, 
      где 
      <P align=justify>dB = 10 log P2/P1, 
      <P align=justify>причем P1 - это мощность сигнала на станции-передатчике, 
      а P2 - мощность сигнала на входе станции-приемника. Так как мощность по 
      мере передачи сигнала по кабелю уменьшается, то затухание получается 
      отрицательным. 
      <P align=justify>В соответствии с принятыми в стандарте Fiber PMD 
      параметрами затухания кабеля и выпускаемыми промышленностью соединителями, 
      считается, что для обеспечения затухания -11 dB длина оптического кабеля 
      между соседними узлами не должна превышать 2 км. 
      <P align=justify>Более точно можно рассчитать корректность физического 
      соединения между узлами, если принять во внимание точные характеристики 
      затухания, вносимые кабелем, разъемами, спайками кабеля, а также мощность 
      передатчика и чувствительность приемника. 
      <P align=justify>Стандарт Fiber PMD определяет следующие предельные 
      значения параметров элементов физического соединения (называемые FDDI 
      Power Budget): 
      <P>&nbsp; 
      <TABLE cellPadding=5 width=500 border=1>
        <TBODY>
        <TR>
          <TD><B>Категория элемента </B></TD>
          <TD><B>Значение</B></TD></TR>
        <TR>
          <TD>Максимальная мощность передатчика </TD>
          <TD>- 14 dBm</TD></TR>
        <TR>
          <TD>Минимальная мощность передатчика </TD>
          <TD>- 20 dBm</TD></TR>
        <TR>
          <TD>Максимальная принимаемая мощность </TD>
          <TD>- 14 dBm</TD></TR>
        <TR>
          <TD>Минимальная принимаемая мощность </TD>
          <TD>- 31 dBm</TD></TR>
        <TR>
          <TD>Максимальные потери между станциями </TD>
          <TD>- 11dB</TD></TR>
        <TR>
          <TD>Максимальные потери на км кабеля </TD>
          <TD>- 2.5 dB</TD></TR></TBODY></TABLE>
      <P align=justify>Абсолютные значения мощности оптических сигналов (для 
      выхода передатчика и для входа приемника) измеряются в децибелах по 
      отношению к стандартной мощности в 1 милливатт (mW) и обозначаются как 
      dBm: 
      <P align=justify>dBm = 10 log P/1, 
      <P align=justify>где мощность Р также измерена в милливаттах. 
      <P align=justify>Из значений таблицы видно, что максимальные потери между 
      станциями в -11 dB соответствуют наихудшему сочетанию предельных значений 
      мощности передатчика (- 20 dBm) и приемника (- 31 dBm). 
      <P align=justify><B>Кабели и разъемы</B> 
      <P align=justify>Основной вид кабеля для стандарта Fiber PMD - 
      многомодовый кабель с диаметром сердечника 62.5 мкм и диаметром отражающей 
      оболочки 125 мкм. Спецификация Fiber PMD не определяет требования к 
      затуханию кабеля в dB на км, а только требует соблюдения требования по 
      общему затуханию в -11 dB между станциями, соединенными кабелем и 
      разъемами. Полоса пропускания кабеля должна быть не хуже чем 500 МГц на 
      км. 
      <P align=justify>Кроме основного вида кабеля, спецификация Fiber PMD 
      допускает использование многомодовых кабелей с диаметром сердечника в 50 
      мкм, 85 мкм и 100 мкм. 
      <P align=justify>В качестве разъемов стандарт Fiber PMD определяет 
      оптические разъемы MIC (Media Interface Connector). Разъем MIC 
      обеспечивает подключение 2-х волокон кабеля, соединенных с вилкой MIC, к 
      2-м волокнам порта станции, соединенными с розеткой MIC. Стандартизованы 
      только конструктивные параметры розетки MIC, а любые вилки MIC, подходящие 
      к стандартным розеткам MIC, считаются пригодными к использованию. 
      <P align=justify>Спецификация Fiber PMD не определяет уровень потерь в 
      разъеме MIC. Этот уровень - дело производителя, главное, чтобы 
      выдерживался допустимый уровень потерь -11 dB во всем физическом 
      соединении. 
      <P align=justify>Разъемы MIC должны иметь ключ, обозначающий тип порта, 
      что должно предотвратить неверное соединение разъемов. Определено четыре 
      различных типа ключа: 
      <UL>
        <LI>MIC A. 
        <LI>MIC B. 
        <LI>MIC M. 
        <LI>MIC S. </LI></UL>
      <P align=justify>Виды ключа для этих типов разъемов приведены на рисунке 
      49. 
      <CENTER>
  <P><img src="images/2_049.gif" width="436" height="492"> 
  <P><I>Рис. 49. Ключи разъемов MIC</I></CENTER>
      <P align=justify>Кроме разъемов MIC, допускается использовать разъемы ST и 
      SC, выпускаемые промышленностью. 
      <P align=justify>В качестве источника света допускается использование 
      светодиодов (LED) или лазерных диодов с длиной волны 1.3 мкм. 
      <P align=justify>Кроме многомодового кабеля, допускается использование 
      более качественного одномодового кабеля (Single Mode Fiber, SMF) и 
      разъемов SMF-MIC для этого кабеля. В этом случае дальность физического 
      соединения между соседними узлами может увеличиться до 40 км - 60 км, в 
      зависимости от качества кабеля, разъемов и соединений. Требования, 
      определенные в спецификации SMF-PMD, для мощности на выходе передатчика и 
      входе приемника, те же, что и для одномодового кабеля. 
      <P align=justify><B>Функция определения сигнала уровня PMD</B> 
      <P align=justify>Спецификация на Fiber PMD требует от этого уровня 
      выполнения функции Signal_Detect по определению факта наличия оптических 
      сигналов на входе физического соединения станции. Этот сигнал передается 
      на уровень PHY, где используется функцией определения статуса линии Line 
      State Detect (рис. 50). 
      <P align=justify>Уровень PMD генерирует для PHY признак присутствия 
      оптического сигнала Signal_Detect, если мощность входного сигнала 
      превышает -43.5 dBm, а снимает его при уменьшении этой мощности до -45 dBm 
      и ниже. Таким образом, имеется гистерезис в 1.5 dBm для предотвращения 
      частых изменений статуса линии при колебании входной мощности сигнала 
      около -45 dBm. 
      <CENTER>
      
  <P>&nbsp; 
  <P><I>Рис. 50. Функция определения сигнала на входе PMD<img src="images/2_050.gif" width="372" height="222"></I>
</CENTER>
      
<h3><a name="21_8"></a>21.8. Физический подуровень PHY</h3>
      <P align=justify>Если в задачи подуровня PMD входит формирование 
      качественных оптических импульсов на выходе и входе каждого физического 
      соединения, то подуровень PHY имеет дело с передачей с помощью импульсов 
      PMD логических единиц и нулей, приходящих с подуровня MAC. Более точно, 
      подуровень PHY занимается следующими задачами: 
      <UL>
        <LI>Определение моментов времени снятия информации по сигналам, 
        поступающим от подуровня PMD (тактирование входных сигналов). 
        <LI>Определение границ байт при обмене данными с MAC-подуровнем. 
        <LI>Кодирование поступающих от MAC-подуровня символов в соответствующий 
        физический код (NRZI или MLT-3) подуровня PMD. 
        <LI>Декодирование поступающих от PMD сигналов (NRZI или MLT-3) в символы 
        MAC-подуровня. 
        <LI>Управление эластичным буфером (Elasticity Buffer) для согласования 
        частоты входных и выходных сигналов. 
        <LI>Определение статуса входящей физической линии на основе тестовой 
        последовательности управляющих символов. 
        <LI>Генерация последовательности управляющих символов для выходящей 
        физической линии по командам от подуровня SMT. 
        <LI>Фильтрация приходящих ошибочных символов для исключения их передачи 
        на выходную линии. </LI></UL>
      <P align=justify><B>Коды 4B/5B и их прием с помощью эластичного буфера</B> 

      <P align=justify>Принципы логического кодирования с использованием кодов 
      4В/5В, а также физического кодирования с помощью методов NRZI (для 
      оптоволокна) и MLT-3 (для витой пары) уже были рассмотрены, так как 
      технология Fast Ethernet позаимствовала их у технологии FDDI. 
      <P align=justify>Кроме 16 кодов, отведенных для 16 кодовых комбинаций 
      исходных 4-х байтовых символов, физический и МАС-уровни оперируют 
      нескольким служебными символами: 
      <UL>
        <LI>Символы состояния линии: 
        <UL>
          <LI>Quiet, Q (молчание) - 00000; 
          <LI>Idle, I (простой) - 11111; 
          <LI>Halt,I (останов) - 00100.<BR>Эти символы позволяют соседям по 
          физическому соединению определить его состояние в процессе его 
          инициализации и поддержания. </LI></UL>
        <LI>Символы ограничителей начала и конца кадра: 
        <UL>
          <LI>Start Delimiter 1 (первый символ границы начала кадра) - 11000; 
          <LI>Start Delimiter 2 (второй символ границы начала кадра) - 10001; 
          <LI>Ending Delimiter (конец кадра) - 01101.<BR>Начало кадра отмечает 
          встретившиеся подряд два символа Start Delimiter 1 и Start Delimiter 
          2, называемых также символами J и K (по аналогии со стандартом Token 
          Ring). </LI></UL>
        <LI>Символы логического нуля и логической единицы: 
        <UL>
          <LI>Reset (логический нуль) - 00111; 
          <LI>Set (логическая единица) - 11001.<BR>Эти символы используются для 
          указания логических значений признаков распознавания адреса, ошибки и 
          копирования кадра, имеющих в кадре FDDI назначение, аналогичное 
          назначению соответствующих признаков кадра Token Ring. </LI></UL>
        <LI>Запрещенные символы - это все символы, которые не являются 
        служебными кодами или 5-битными кодами, использованными для записи 16 
        возможных комбинаций 4-х разрядных кодов. </LI></UL>
      <P align=justify>В обязанности физического уровня входит фильтрация 
      символов, передаваемых на выходную линию порта. Если среди символов кадра 
      встречаются запрещенные символы, то они заменяются на 4 символа Halt, 
      которые далее сопровождаются символами Idle до передачи следующего кадра. 
      Последующий сосед, получив кадр с 4-мя символами Halt, должен изъять 
      поврежденный кадр из кольца. Функция фильтрации не обязательна, когда кадр 
      проходит через МАС-блок станции, но это происходит не всегда, например, 
      вторичное кольцо может проходить только через блоки физического уровня, не 
      заходя в МАС-блок, если это станция с двойным подключением. 
      <P align=justify>Рассмотрим подробней, каким образом происходит 
      синхронизация приемника с передатчиком в сети FDDI при приеме кодов 4B/5В. 

      <P align=justify>Сеть FDDI использует распределенную схему тактирования 
      информации, при которой каждая станция работает со своим независимым 
      локальным тактовым генератором. Это отличает ее от сетей Token Ring, в 
      которых одна станция поддерживает тактирование информации для всей сети, 
      управляя главным тактовым генератором сети, называемым Master Clock. 
      <P align=justify>В сети FDDI тактовые частоты синхронизируются в каждом 
      физическом соединении соседних станций (рис. 51). 
      <P align=justify>Каждая станция имеет два тактовых генератора - локальный, 
      который управляет тактированием передаваемой информации, и 
      восстанавливающим, который синхронизируется с тактовой частотой данных, 
      приходящих от соседней станции. Локальный тактовый генератор работает на 
      тактовой частоте 125 Мгц ± 0.005%. Восстанавливающий тактовый генератор, 
      называемый RCRCLK (Receive Recovery Clock) подстраивается под тактовую 
      частоту, извлекаемую из NRZI или MLT-3 сигналов при поступлении кодов Idle 
      в промежутке между передачей кадров данных. Коды Idle, имеющие значение 
      111111, создают последовательность импульсов типа "меандр" с равными 
      длительностями высокого и низкого потенциала, удобных для подстройки 
      тактового генератора RCRCLK, так как сигнал изменяется два раза за период. 

      <P align=justify>Поступающие символы записываются в соответствии с 
      обнаруженной в импульсах кодов Idle частотой в эластичный буфер 
      (Elasticity Buffer). Из эластичного буфера символы извлекаются уже с 
      частотой локального генератора. В результате, рассогласование частот 
      станций в кольце постоянно сглаживается, не превышая 0.01%. Принимающая 
      станция поддерживает заполнение эластичного буфера наполовину, извлекая 
      очередной символ только при превышении этой границы. 
      <CENTER>
  <P><img src="images/2_051.gif" width="461" height="381"> 
  <P><I>Рис. 51. Согласование тактовых генераторов в сети FDDI</I></CENTER>
      <P align=justify><B>Процедура установления физического соединения</B> 
      <P align=justify>Блоки PMD и PHY, реализующие физический уровень 
      технологии FDDI для каждого порта, участвуют в процедуре инициализации 
      физического соединения каждого порта станции с портом предшествующей или 
      последующей станций. Эта процедура проводится при непосредственном участии 
      блока управления станцией - SMT (Station Management). Блок управления 
      станцией выполняет большое количество функций, получая информацию и 
      управляя всеми остальными блоками станции - PMD, PHY и MAC. Рассмотрим 
      группу функций SMT, управляющих физическими соединениями портов и 
      конфигурацией внутреннего пути данных. Эта группа функций получила 
      название Connection Management (CMT). 
      <P align=justify>На рисунке 52 показан состав функций CMT и связь их с 
      блоками PMD, PHY, MAC и некоторыми другими элементами станции. 
      <CENTER>
  <P><img src="images/2_052.gif" width="345" height="326"> 
  <P><I>Рис. 52. Структура блока управления конфигурацией CMT</I></CENTER>
      <P align=justify>Станция, имеющая несколько портов, обеспечивает для 
      каждого из них блоки PMD, PHY и элемент управления конфигурацией CCE 
      (Control Configuration Element). ССЕ - это переключатель, который 
      соединяет входы и выходы первичного и вторичного колец, подключенных к 
      порту извне, с внутренними путями данных станции, в результате данные 
      могут передаваться из порта элементу MAC станции, а могут непосредственно 
      переправляться на другой порт. Реконфигурация станции при ее реакции на 
      отказы производится именно переключателем CCE. 
      <P align=justify>Блок управления конфигурацией имеет в своем составе 
      несколько элементов PCM (Physical Connection Management), по одному на 
      каждый порт. Элемент PCM управляет физическим состоянием линии своего 
      порта, анализируя символы, приходящие от PHY, и передавая PHY свои 
      команды. Если элемент PCM обнаруживает изменение состояния линии, то он 
      оповещает об этом элемент CFM (Configuration Management), который отвечает 
      за конфигурацию внутреннего пути данных. Элемент CFM производит 
      конфигурирование внутреннего пути, управляя переключателями портов CCE. 
      Делает он это с помощью элементов CEM (Configuration Element Management), 
      каждый из которых управляет одним переключателем CCE. Блок ECM (Entity 
      Coordination Management) координирует работу всех блоков и элементов блока 
      управления конфигурацией CMT. 
      <P align=justify>Установление физического соединения - основная задача 
      блока PCM. Блок PCM каждого порта начинает эту процедуру по команде 
      PC_Start, получаемой от координирующего элемента ECM (рис. 53). 
      <CENTER>
  <P><img src="images/2_053.gif" width="362" height="214"> 
  <P><I>Рис. 53. Управление физическим соединением портов </I></CENTER>
      <P align=justify>При получении этой команды блок PCM локального порта 
      начинает обмениваться символами кодов 4B/5B по миникольцу, образуемому 
      двумя соседними портами. Процедура инициализации физического соединения - 
      это распределенная процедура, в ней участвуют два РСM соседних портов. 
      <P align=justify>Во время этой процедуры для обмена информацией соседние 
      порты используют не отдельные символы, а достаточно длинные 
      последовательности символов, что повышает надежность взаимодействия. Эти 
      последовательности называются состоянием линии. Всего используется 4 
      состояния линии: 
      <UL>
        <LI>Quiet Line State, QLS - состояние молчания, состоит в передаче 16 
        или 17 символов Quiet подряд. 
        <LI>Master Link State, MLS - состояние главного порта, состоит в 
        передаче 8 или 9 пар символов Halt-Quiet. 
        <LI>Halt Link State, HLS - состояние останова, состоит в передаче 16 или 
        17 символов Halt подряд. 
        <LI>Idle Link State, ILS - состояние простоя, состоит в передаче 16 или 
        17 символов Idle подряд. </LI></UL>
      <P align=justify>Первый этап инициализации заключается в передаче портом - 
      инициатором соединения - состояния QLS соседнему порту. Тот должен при 
      этом перейти в состояние BREAK - разрыва связи, независимо от того, в 
      каком состоянии связь находилась до получения символов QLS. Соседний порт, 
      перейдя в состояние BREAK, также посылает символы QLS, обозначая свой 
      переход. 
      <P align=justify>После того, как порт-инициатор убедился, что первый этап 
      инициализации выполнен, он выполняет следующий этап - переход в состояние 
      CONNECT (соединение). Делает он это посылкой символов HLS, на что соседний 
      порт также должен ответить символами HLS. 
      <P align=justify>Если состояние CONNECT установлено, то порт-инициатор 
      начинает наиболее содержательный этап инициализации - NEXT, включающий 
      обмен информацией о типе портов, проведение тестирования качества линии и 
      проведение тестового обмена МАС-кадрами. Этап NEXT состоит в обмене между 
      соседними портами 10-ю сообщениями, которые передаются по очереди. Порт 
      передает одно свое сообщение, затем получает и анализирует сообщение от 
      соседа и так далее. Каждое сообщение несет один бит информации и 
      кодируется последовательностями MLS - логический ноль, или HLS - 
      логическая единица. 
      <P align=justify>Первые два сообщения несут информацию о типе своего 
      порта. Для кодирования нужны два бита, так как существует четыре типа 
      портов - А, В, М или S. Третье сообщение говорит соседнему порту, 
      приемлемо ли для данного порта соединение с указанным в принятых 
      сообщениях типом порта. Если да, то следующие сообщения оговаривают 
      длительность процедуры тестирования качества линии, а затем передают 
      информацию о результатах тестирования. Тест состоит в передаче в течение 
      определенного времени символов Idle и подсчете искаженных символов. Если 
      качество линии приемлемо, то выполняется тестовый обмен кадрами данных с 
      участием блоков MAC станций. 
      <P align=justify>Если все этапы инициализации прошли успешно, то 
      физическое соединение считается установленным и активным. По нему начинают 
      передаваться символы простоя и кадры данных. Однако, до тех пор, пока 
      станция не выполнит процедуру логического вхождения станции в кольцо, эти 
      кадры могут нести только служебную информацию. 
      <P align=justify><B>Конфигурирование внутреннего пути</B> 
      <P align=justify>После установления физического соединения станция должна 
      включить порт во внутренний путь, по которому проходят кадры данных и 
      маркер. 
      <P align=justify>Средством, с помощью которого выполняется это включение, 
      является переключатель CCE. Он может подключить вход и выход порта к 
      любому из трех внутренних путей станции (рис. 54) по командам от элемента 
      CEM блока управления конфигурацией CMT. 
      <CENTER>
  <P><img src="images/2_054.gif" width="426" height="257"> 
  <P><I>Рис. 54. Подключение порта к внутренним путям станции</I></CENTER>
      <P align=justify>Внутренние пути станции не следует путать с внешними 
      первичным и вторичным кольцами сети. Внутренние пути могут соединяться с 
      любым из колец в зависимости от состояния порта. 
      <P align=justify>Первичный внутренний путь обязательно должен 
      присутствовать у любой станции. Вторичный внутренний путь является 
      необязательным, но желательным в некоторых конфигурациях станций с двойным 
      подключением, как это будет видно из примеров. Локальный путь используется 
      для тестирования станции на МАС-уровне перед ее логическим включением в 
      кольцо. 
      <P align=justify>Переключатель CCE может находиться в одном из 5 состояний 
      (рис. 55): 
      <UL>
        <LI>ISOLATED - изолированное состояние, когда все пути идут мимо входа и 
        выхода порта. 
        <LI>INSERT_P - порт включен в первичный внутренний путь. 
        <LI>INSERT_S - порт включен во вторичный внутренний путь. 
        <LI>INSERT_X - порт включен в первичный и вторичный внутренние пути. Это 
        состояние используется для сворачивания первичного и вторичного внешних 
        колец на данном порту (состояние WRAP сети). 
        <LI>LOCAL - порт включен в локальный внутренний путь. </LI></UL>
      <CENTER>
  <P><img src="images/2_055.gif" width="437" height="341"> 
  <P><I>Рис. 55. Состояния переключателя внутренних путей</I></CENTER>
      <P align=justify>С помощью перевода переключателей портов станции в нужное 
      состояние блок управления конфигурацией может обеспечить передачу кадров и 
      маркера по тому внутреннему пути, который соответствует текущему состоянию 
      сети. На рисунке 56 приведены примеры поддержки состояний THRU_A ( а) и 
      WRAP_A (б) для станции с двойным подключением. 
      <P align=justify>Состояние THRU_A соответствует нормальному режиму работы 
      колец сети. В этом режиме первичное кольцо проходит через порты А и В, а 
      также MAC-узел станции, а вторичное кольцо проходит только через блоки PMD 
      и PHY каждого из портов. Состояние WRAP_A соответствует реакции сети на 
      нарушение целостности сети, при котором порт В теряет физическое 
      соединение с соседним по сети портом. При этом на линии устанавливается 
      состояние Quiet Line State, так как отсутствие сигналов на входе порта 
      соответствует получению символов Quiet (00000). Получив информацию о том, 
      что на входе порта В установилось состояние QLS, блок PCM этого порта 
      пытается начать процесс реинициализации физического соединения. При 
      отсутствии физической связи между портами эта попытка называется удачной, 
      поэтому порт переводится в состояние INSERT_X, а порт В - в состояние 
      ISOLATED. 
      <CENTER>
  <P><img src="images/2_056.gif" width="380" height="497"> 
  <P><I>Рис. 56. Работа переключателя пути CCE в станции с двойным 
      подключением</I></CENTER>
  
<p><a href="lection_20.htm">Назад</a> | <a href="index.htm">Содержание</a> | <a href="pril.htm">Вперед</a></p> 
</body>
</html>
