<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>Основные характеристики стандарта Token Ring</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1251">
</head>

<body>
<h3>18.1. Основные характеристики стандарта Token Ring</h3>
      <P align=justify>Сети стандарта Token Ring, также как и сети Ethernet, 
      используют разделяемую среду передачи данных, которая состоит из отрезков 
      кабеля, соединяющих все станции сети в кольцо. Кольцо рассматривается как 
      общий разделяемый ресурс, и для доступа к нему используется не случайный 
      алгоритм, как в сетях Ethernet, а детерминированный, основанный на 
      передаче станциями права на использование кольца в определенном порядке. 
      Право на использование кольца передается с помощью кадра специального 
      формата, называемого маркером или токеном. 
      <P align=justify>Стандарт Token Ring был принят комитетом 802.5 в 1985 
      году. В это же время компания IBM приняла стандарт Token Ring в качестве 
      своей основной сетевой технологии. В настоящее время именно компания IBM 
      является основным законодателем моды технологии Token Ring, производя 
      около 60% сетевых адаптеров этой технологии. 
      <P align=justify>Сети Token Ring работают с двумя битовыми скоростями - 4 
      Мб/с и 16 Мб/с. Первая скорость определена в стандарте 802.5, а вторая 
      является новым стандартом де-факто, появившимся в результате развития 
      технологии Token Ring. Смешение станций, работающих на различных 
      скоростях, в одном кольце не допускается. 
      <P align=justify>Сети Token Ring, работающие со скоростью 16 Мб/с, имеют и 
      некоторые усовершенствования в алгоритме доступа по сравнению со 
      стандартом 4 Мб/с. 
	        
<h3>18.2. Маркерный метод доступа к разделяемой среде</h3>
      <P align=justify>В сетях с <I>маркерным методом </I>доступа право на 
      доступ к среде передается циклически от станции к станции по логическому 
      кольцу. Кольцо образуется отрезками кабеля, соединяющими соседние станции. 
      Таким образом, каждая станция связана со своей предшествующей и 
      последующей станцией и может непосредственно обмениваться данными только с 
      ними. Для обеспечения доступа станций к физической среде по кольцу 
      циркулирует кадр специального формата и назначения - <I>маркер 
      (токен)</I>. 
      <P align=justify>Получив маркер, станция анализирует его, при 
      необходимости модифицирует и при отсутствии у нее данных для передачи 
      обеспечивает его продвижение к следующей станции. Станция, которая имеет 
      данные для передачи, при получении маркера изымает его из кольца, что дает 
      ей право доступа к физической среде и передачи своих данных. Затем эта 
      станция выдает в кольцо кадр данных установленного формата последовательно 
      по битам. Переданные данные проходят по кольцу всегда в одном направлении 
      от одной станции к другой. 
      <P align=justify>При поступлении кадра данных к одной или нескольким 
      станциям, эти станции копируют для себя этот кадр и вставляют в этот кадр 
      подтверждение приема. Станция, выдавшая кадр данных в кольцо, при обратном 
      его получении с подтверждением приема изымает этот кадр из кольца и выдает 
      новый маркер для обеспечения возможности другим станциям сети передавать 
      данные. 
      <P align=justify>На рисунке 12 описанный алгоритм доступа к среде 
      иллюстрируется временной диаграммой. Здесь показана передача пакета А в 
      кольце, состоящем из 6 станций, от станции 1 к станции 3. 
      <CENTER>
  <P><img src="images/2_012.gif" width="485" height="606"> 
  <P><I>Рис. 12. Принцип маркерного доступа</I></CENTER>
      <P align=justify>Время удержания одной станцией маркера ограничивается 
      <I>тайм-аутом удержания маркера, </I>после истечение которого станция 
      обязана передать маркер далее по кольцу. 
      <P align=justify>В сетях Token Ring 16 Мб/с используется также несколько 
      другой алгоритм доступа к кольцу, называемый алгоритмом <I>раннего 
      освобождения маркера (Early Token Release).</I> В соответствии с ним 
      станция передает маркер доступа следующей станции сразу же после окончания 
      передачи последнего бита кадра, не дожидаясь возвращения по кольцу этого 
      кадра с битом подтверждения приема. В этом случае пропускная способность 
      кольца используется более эффективно и приближается к 80 % от номинальной. 

      <P align=justify>Для различных видов сообщений передаваемым данным могут 
      назначаться различные <I>приоритеты.</I> 
      <P align=justify>Каждая станция имеет механизмы обнаружения и устранения 
      неисправностей сети, возникающих в результате ошибок передачи или 
      переходных явлений (например, при подключении и отключении станции). 
      <P align=justify>Не все станции в кольце равны. Одна из станций 
      обозначается как <I>активный монитор, </I>что означает дополнительную 
      ответственность по управлению кольцом. Активный монитор осуществляет 
      управление тайм-аутом в кольце, порождает новые маркеры (если необходимо), 
      чтобы сохранить рабочее состояние, и генерирует диагностические кадры при 
      определенных обстоятельствах. Активный монитор выбирается, когда кольцо 
      инициализируется, и в этом качестве может выступить любая станция сети. 
      Если монитор отказал по какой-либо причине, существует механизм, с помощью 
      которого другие станции (резервные мониторы) могут договориться, какая из 
      них будет новым активным монитором. 
      
<h3>18.3. Форматы кадров Token Ring</h3>
      <P align=justify>
      <P align=justify>В Token Ring существует три различных формата кадров: 
      <OL>
        <LI>маpкеp; 

        <LI>кадp данных; 
        <LI>пpеpывающая последовательность. </LI></OL>
<P align=justify><B><I>Маркер</I></B> 
      <P align=justify>Кадр маркера состоит из трех полей, каждое длиной в один 
      байт. 
      <UL>
        <LI><I>Поле начального ограничителя </I>появляется в начале маркера, а 
        также в начале любого кадра, проходящего по сети. Поле состоит из 
        уникальной серии электрических импульсов, которые отличаются от тех 
        импульсов, которыми кодируются единицы и нули в байтах данных. Поэтому 
        начальный ограничитель нельзя спутать ни с какой битовой 
        последовательностью. 
        <LI><I>Поле контроля доступа.</I> Разделяется на четыре элемента данных: 
        <BR>PPP T M RRR, <BR>где PPP - биты приоритета, T - бит маркера, M - бит 
        монитора, RRR - резервные биты. 
        <P align=justify>Каждый кадр или маркер имеет приоритет, устанавливаемый 
        битами приоритета (значение от 0 до 7, 7 - наивысший приоритет). Станция 
        может воспользоваться маркером, если только она получила маркер с 
        приоритетом, меньшим или равным, чем ее собственный. Сетевой адаптер 
        станции, если ему не удалось захватить маркер, помещает свой приоритет в 
        резервные биты маркера, но только в том случае, если записанный в 
        резервных битах приоритет ниже его собственного. Эта станция будет иметь 
        преимущественный доступ при последующем поступлении к ней маркера. 
        <P align=justify>Схема использования приоритетного метода захвата 
        маркера показана на рисунке 13. Сначала монитор помещает в поле текущего 
        приоритета P максимальное значение приоритета, а поле резервного 
        приоритета R обнуляется (маркер 7110). Маркер проходит по кольцу, в 
        котором станции имеют текущие приоритеты 3, 6 и 4. Так как эти значения 
        меньше, чем 7, то захватить маркер станции не могут, но они записывают 
        свое значение приоритета в поле резервного приоритета, если их приоритет 
        выше его текущего значения. В результате маркер возвращается к монитору 
        со значением резервного приоритета R = 6. Монитор переписывает это 
        значение в поле P, а значение резервного приоритета обнуляет, и снова 
        отправляет маркер по кольцу. При этом обороте его захватывает станция с 
        приоритетом 6 - наивысшим приоритетом в кольце в данный момент времени. 
        <P align=justify>Бит маркера имеет значение 0 для маркера и 1 для кадра. 

        <P align=justify>Бит монитора устанавливается в 1 активным монитором и в 
        0 любой другой станцией, передающей маркер или кадр. Если активный 
        монитор видит маркер или кадр, содержащий бит монитора в 1, то активный 
        монитор знает, что этот кадр или маркер уже однажды обошел кольцо и не 
        был обработан станциями. Если это кадр, то он удаляется из кольца. Если 
        это маркер, то активный монитор переписывает приоритет из резервных 
        битов полученного маркера в поле приоритета. Поэтому при следующем 
        проходе маркера по кольцу его захватит станция, имеющая наивысший 
        приоритет. </P>
        <LI><I>Поле конечного ограничителя </I>- последнее поле маркера. Так же, 
        как и поле начального ограничителя, это поле содержит уникальную серию 
        электрических импульсов, которые нельзя спутать с данными. Кроме отметки 
        конца маркера это поле также содержит два подполя: бит промежуточного 
        кадра и бит ошибки. Эти поля относятся больше к кадру данных, который мы 
        и рассмотрим. </LI></UL>
      <CENTER>
  <P><img src="images/2_013.gif" width="543" height="492"> 
  <P><I>Рис. 13. Приоритеты в кольце Token Ring</I></CENTER>
      
<P><B><I>Кадр данных</I></B> 
<P align=justify>Кадр данных состоит из нескольких групп полей: 
      <UL>
        <LI>последовательность начала кадра; 
        <LI>адрес получателя; 
        <LI>адрес отправителя; 
        <LI>данные; 
        <LI>последовательность контроля кадра; 
        <LI>последовательность конца кадра. </LI></UL>
      <P align=justify>Кадр данных может переносить данные либо для управления 
      кольцом (данные MAC-уровня), либо пользовательские данные (LLC-уровня). 
      Стандарт Token Ring определяет 6 типов управляющих кадров MAC-уровня. 
      <I>Поле "последовательность начала кадра"</I> определяет тип кадра (MAC 
      или LLC) и, если он определен как MAC, то поле также указывает, какой из 
      шести типов кадров представлен данным кадром. 
      <P align=justify>Назначение этих шести типов кадров следующее. 
      <UL>
        <LI>Чтобы удостовериться, что ее адрес уникальный, станция посылает кадр 
        "Тест дублирования адреса", когда впервые присоединяется к кольцу. 
        <LI>Чтобы сообщить другим станциям, что он еще жив, активный монитор 
        запускает кадр "Активный монитор существует" так часто, как только 
        может. 
        <LI>Кадр "Существует резервный монитор" отправляется любой станцией, не 
        являющейся активным монитором. 
        <LI>Резервный монитор отправляет "Маркеры заявки", когда подозревает, 
        что активный монитор отказал. Резервные мониторы затем договариваются 
        между собой, какой из них станет новым активным монитором. 
        <LI>Станция отправляет кадр "Сигнал" в случае возникновения серьезных 
        сетевых проблем, таких как оборванный кабель, или при обнаружении 
        станции, передающей кадры без ожидания маркера. Определяя, какая станция 
        отправляет кадр сигнала, диагностирующая программа может локализовать 
        проблему. 
        <LI>Кадр "Очистка" отправляется после того, как произошла инициализация 
        кольца, и новый активный монитор заявляет о себе. </LI></UL>
      <P align=justify>Каждый кадр (MAC или LLC) начинается с 
      <I>"последовательности начала кадра"</I>, которая содержит три поля: 
      <UL>
        <LI>Начальный ограничитель, такой же, как и для маркера; 
        <LI>Управление доступом, также совпадает для кадров и для маркеров; 
        <LI>Контроль кадра - это однобайтовое поле, содержащее два подполя - тип 
        кадра и идентификатор управления MAC: 2 бита типа кадра имеют значения 
        00 для кадров MAC и 01 для кадров LLC. Биты идентификатора управления 
        MAC определяют тип кадра управления кольцом из приведенного выше списка 
        6-ти управляющих кадров MAC. </LI></UL>
      <P align=justify>Адрес получателя (либо 2, либо 6 байтов). Первый бит 
      определяет групповой или индивидуальный адрес как для 2-х байтовых, так и 
      для 6-ти байтовых адресов. Второй бит в 6-ти байтовых адресах говорит, 
      назначен адрес локально или глобально. 
      <P align=justify>Адрес отправителя имеет тот же размер и формат, что и 
      адрес получателя. 
      <P align=justify>Поле данных кадра может содержать данные одного из 
      описанных управляющих кадров MAC или запись пользовательских данных, 
      предназначенных для (или получаемых от) протокола более высокого уровня, 
      такого как IPX или NetBIOS. Это поле не имеет определенной максимальной 
      длины, хотя существуют практические ограничения на его размер, основанные 
      на временных требованиях к тому, как долго некоторая станция может 
      управлять кольцом. 
      <P align=justify>Последовательность контроля кадра - используется для 
      обнаружения ошибок, состоит из четырех байтов остатка циклически 
      избыточной контрольной суммы, вычисляемой по алгоритму CRC-32, 
      осуществляющему циклическое суммирование по модулю 32. 
      <P align=justify>Последовательность конца кадра состоит из двух полей: 
      конечный ограничитель и статус кадра. 
      <P align=justify><I>Конечный ограничитель </I>в кадре данных имеет 
      дополнительное значение по сравнению с маркером. Кроме уникальной 
      последовательности электрических импульсов он содержит два однобитовых 
      поля: бит промежуточного кадра и бит обнаружения ошибки. Бит 
      промежуточного кадра устанавливается в 1, если этот кадр является частью 
      многокадровой передачи, или в 0 для последнего или единственного кадра. 
      Бит обнаружения ошибки первоначально установлен в 0; каждая станция, через 
      которую передается кадр, проверяет его на ошибки (по коду CRC) и 
      устанавливает бит обнаружения ошибки в 1, если она выявлена. Очередная 
      станция, которая видит уже установленный бит обнаружения ошибки, должна 
      просто передать кадр. Исходная станция заметит, что возникла ошибка, и 
      повторит передачу кадра. 
      
<P align=justify>Статус кадра имеет длину 1 байт и содержит 4 резервных бита и 
  два подполя: бит распознавания адреса и бит копирования кадра. Так как это поле 
  не сопровождается вычисляемой суммой CRC, то используемые биты дублируются в 
  байте. Когда кадр создается, передающая станция устанавливает бит распознавания 
  адреса в 0; получающая станция устанавливает бит в 1, чтобы сообщить, что она 
  опознала адрес получателя. Бит копирования кадра также вначале установлен в 
  0, но устанавливается в 1 получающей станцией (станцией назначения), когда она 
  копирует содержимое кадра в собственную память (другими словами, когда она реально 
  получает данные). Данные копируются (и бит устанавливается), если только кадр 
  получен без ошибок. Если кадр возвращается с обоими установленными битами, исходная 
  станция знает, что произошло успешное получение. Если бит распознавания адреса 
  не установлен во время получения кадра, это означает, что станция назначения 
  больше не присутствует в сети (возможно, вследствие неполадок). Возможна другая 
  ситуация, когда адрес получателя опознается, но бит копирования кадра не установлен. 
  Это говорит исходной станции, что кадр был искажен во время передачи (бит обнаружения 
  ошибки в конечном ограничителе также будет установлен). Если оба бита опознавания 
  адреса и копирования кадра установлены, и бит обнаружения ошибки также установлен, 
  то исходная станция знает, что ошибка случилась после того, как этот кадр был 
  корректно получен. 
<P align=justify><B><I>Прерывающая последовательность</I></B> 
      <P align=justify>Состоит из двух байтов, содержащих начальный ограничитель 
      и конечный ограничитель. Прерывающая последовательность может появиться в 
      любом месте потока битов и сигнализирует о том, что текущая передача кадра 
      или маркера отменяется. 
      <P align=justify>Как видно из описания процедур обмена данными, в сети 
      Token Ring на уровнях MAC и LLC применяются процедуры без установления 
      связи, но с подтверждением получения кадров. 
        
<h3>18.4. Физическая реализация сетей Token Ring</h3>
      <P align=justify>Стандарт Token Ring фирмы IBM предусматривает построение 
      связей в сети как с помощью непосредственного соединения станций друг с 
      другом, так и образование кольца с помощью концентраторов (называемых MAU 
      - Media Attachment Unit или MSAU - Multi-Station Access Unit). 
      <P align=justify>На рисунке 14 показаны основные аппаратные элементы сети 
      Token Ring и способы их соединения. 
      <CENTER>
  <P><img src="images/2_014.gif" width="487" height="515"> 
  <P><I>Рис. 14. Конфигурация кольца Token Ring </I></CENTER>
      <P align=justify>В приведенной конфигурации показаны станции двух типов. 
      <P align=justify>Станции С1, С2 и С3 - это станции, подключаемые к кольцу 
      через концентратор. Обычно такими станциями являются компьютеры с 
      установленными в них сетевыми адаптерами. Станции этого типа соединяются с 
      концентратором ответвительным кабелем (lobe cable), который обычно 
      является экранированной витой парой (Shielded Twisted Pair, STP), 
      соответствующей стандартному типу кабеля из кабельной системы IBM (Type 1, 
      2, 6, 8, 9). 
      <P align=justify>Максимальная длина ответвительного кабеля зависит от типа 
      концентратора, типа кабеля и скорости передачи данных. Обычно для скорости 
      16 Мб/с максимальная длина кабеля Type 1 может достигать 200 м, а для 
      скорости 4 Мб/с - 600 м. Концентраторы Token Ring делятся на активные и 
      пассивные. Пассивные концентраторы обеспечивают только соединения портов 
      внутри концентратора в кольцо, активные выполняют и функции повторителя, 
      обеспечивая ресинхронизацию сигналов и исправление их амплитуды и формы. 
      Естественно, что активные концентраторы поддерживают большие расстояния до 
      станции, чем пассивные. 
      <P align=justify>Остальные станции сети соединены в кольцо 
      непосредственными связями. Такие связи называются магистральными (trunk 
      cable). Обычно связи такого рода используются для соединения 
      концентраторов друг с другом для образования общего кольца. Порты 
      концентраторов, предназначенные для такого соединения, называются портами 
      Ring-In и Ring-Out. 
      <P align=justify>Для предотвращения влияния отказавшей или отключенной 
      станции на работу кольца станции подключаются к магистрали кольца через 
      специальные устройства, называемые устройствами подключения к магистрали 
      (Trunk Coupling Unit, TCU). В функции такого устройства входит образование 
      обходного пути, исключающего заход магистрали в MAC-узел станции при ее 
      отключении или отказе. Обычно для этих целей в TCU используются реле, 
      которые подпитываются постоянным током во время нормальной работы. При 
      пропадании тока подпитки контакты реле переключаются и образуют обходной 
      путь, исключая станцию. 
      <P align=justify>При подключении станции в кольцо через концентратор, 
      устройства TCU встраивают в порты концентратора. 
      <P align=justify>Максимальное количество станций в одном кольце - 250. 
      
<P align=justify>Кроме экранированной витой пары существуют сетевые адаптеры и 
  концентраторы Token Ring, поддерживающие неэкранированную витую пару и оптоволокно. 
<P align=justify><a href="lection_17.htm">Назад</a> | <a href="index.htm">Содержание</a> 
  | <a href="lection_19.htm">Вперед </a>
</body>
</html>
