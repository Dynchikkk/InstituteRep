<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<!-- saved from url=(0046)http://doc.mpv.ru/steps/mfc/net/socket/24.html -->
<HTML><HEAD>
<META http-equiv=Content-Type content="text/html; charset=koi8-r">
<META content="MSHTML 6.00.2900.2180" name=GENERATOR></HEAD>
<BODY text=black vLink=blue aLink=red link=blue bgColor=white><LINK 
href="24.files/1.css" type=text/css rel=stylesheet><FONT color=red>
<H2 align=center>Шаг 24 - Создаем клиента и сервер Socket на MFC.</H2></FONT><PRE>Тема: sockets  
Дата: 21.02.01 19:34  
От кого: Jurik <JURIK_JA@MAIL.RU>   
Кому: Art <KAEV@YANDEX.RU>
</PRE>
<P>Здраствуйте Артём - я недавно вам слал мессаг на счёт того как сделать сервер 
на сокетах ... я разобрался сам уже ... загвоздка была в том, что функции 
<B>Accept()</B> как параметр надо было давать объект класса <B>CSocket</B>, но 
не тот, который я использую и вызываю ему функции <B>Create()</B>, 
<B>Bind()</B>, <B>Listen()</B> и так далее, а второй не троганный не 
инициализированный ! :) Для клиента и для сервера ... всё это дело вставляется в 
реакцию на нажатие кнопки ... я лично использовал Визард и делал <B>Dialog based 
app</B>. 
<P>Сервер: <PRE>CSocket ServerSocket, RecieveSocket; 
ServerSocket.Create(5544);
ServerSocket.Bind(5544, "192.168.93.1");
ServerSocket.Listen(5); 
ServerSocket.Accept(RecieveSocket); 
CSocketFile file(&amp;RecieveSocket);
CArchive In(&amp;file, CArchive::load);
CArchive Out(&amp;file, CArchive::store); 
CString string;
In &gt;&gt; string; 
AfxMessageBox(string); 
ServerSocket.Close(); 
</PRE>
<P>Клиент: <PRE>CSocket ClientSocket;
ClientSocket.Create();
ClientSocket.Connect("192.168.93.1", 5544);
CString buffer = " Hello World";
ClientSocket.Send(buffer, 500, 0); 
ClientSocket.Close(); 
</PRE>
<P>Единственная непонятная ошибка !!! Когда сервер принимает строку, то он 
выводит её начиная со второго символа, а первый пропадает !!! :))) Но принцип 
понятен ! :)))) Буду рад если это окажется полезным ! Пока ! 
<P>
<HR>

<CENTER><FONT size=2><A 
href="http://doc.mpv.ru/steps/mfc/net/socket/23.html">Предыдущий шаг</A> <!--| <a href=.html>Следующий Шаг</a-->| <A 
href="http://doc.mpv.ru/steps/mfc/net/socket/socket.html">Оглавление</A></FONT></CENTER>
<HR>

<CENTER><FONT size=2>By <A href="mailto:kaev@yandex.ru">Artem</A>.</CENTER>
<SCRIPT src="24.files/banners.htm"></SCRIPT>
<!-- ><!-- "><!-- '><!-- --></TEXTAREA></FORM></TITLE></COMMENT></A>
<DIV></DIV></SPAN></ILAYER></LAYER></IFRAME></NOFRAMES></STYLE></NOSCRIPT></TABLE></SCRIPT></APPLET></FONT>
<STYLE>#bn {
	DISPLAY: block
}
#bt {
	DISPLAY: block
}
</STYLE>
</BODY></HTML>
