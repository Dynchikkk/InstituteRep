<HTML>
	<HEAD>
		<TITLE>Методика анализа траффика вычислительной сети с использованием утилиты 
			Network Monitor</TITLE>
	</HEAD>
	<BODY text="#000000" vLink="#003860" aLink="#800000" link="#006890" bgColor="#ffffff"
		topMargin="0" marginheight="0">
		<H3 align="center">&nbsp;</H3>
		<H3 align="center">Методика анализа траффика вычислительной сети с использованием 
			утилиты Network Monitor</H3>
		<BR>
		<OL>
			<LI>
				<A href="Method.htm#_1">Общие&nbsp;сведения</A>
			<LI>
				<A href="Method.htm#_2">Описание утилиты NetMon</A></LI>
		</OL>
		<A name="_1"></A>
		<H4 align="center">1 Введение</H4>
		<P align="justify">
		Утилита Network Monitor предназначена для сбора и анализа данных, передаваемых 
		по вычислительной сети. Потребность в этом может возникнуть при наличии сбоев в 
		работе сети, когда анализ передаваемых пакетов может помочь локализовать и 
		устранить источник ошибок. Кроме того, утилита оказывается полезной при изучении
		сетевых протоколов, так как позволяет просмотреть полное содержимое всех передаваемых
		по сети пакетов с разбором формата их заголовков.
		<P>&nbsp; <A name="_2"></A>
	<H4 align="center">2 Описание утилиты NetMon</H4>
		<P align="justify">
		<P align="justify">Внешний вид утилиты Network Monitor показан на рис 2.1.
			<BR>
			<BR>
		<P align="center"><img src="method.files/21.jpg" border="0">
		<P align="center">Рисунок 2.1 Внешний вид утилиты Network Monitor.
			<BR>
			<BR>
		<P align="justify">Сначала необходимо выбрать сеть, трафик которой вы хотите 
			контролировать. Это делается с помощью меню Capture и пункта Networks. В 
			появившейся панели отображаются все сетевые интерфейсы, которые имеются у 
			вашего компьютера - сетевые адаптеры (если их несколько) и COM-порты службы 
			RAS, если она установлена на компьютере (см. рис 2.2)
			<BR>
		<P align="center"><img src="method.files/22.jpg" border="0">
		<P align="center">Рисунок 2.2. Выбор сети.
			<BR>
			<BR>
		<P align="justify">
		Интерфейс RAS отличается от сетевых адаптеров тем, что он имеет Ethernet-адрес 
		000000000000. В данной работе сначала необходимо выбрать локальную сеть, 
		имеющую отличный от нулей адрес Ethernet (например, 0060081EF346).
		<P align="justify">
			Перед началом сбора статистики следует установить объем буфера для собранных 
			пакетов. Объем буфера определяет количество пакетов, которые утилита сможет 
			сохранить для последующего отображения. Для установки объема буфера следует 
			выбрать пункт Buffer Settings... в меню Capture. При этом на экран будет 
			выведено окно, вид которого представлен на рис. 2.3.
			<BR>
		<P align="center"><img src="method.files/23.jpg" border="0">
		<P align="center">Рисунок 2.3. Установка объема буфера.
			<BR>
			<BR>
		<P align="justify">
		Значение "Frame Size" определяет размер, до которого будут обрезаться пакеты, 
		если их длина больше этого значения. В этом поле следует оставить значение 
		"Full". Поле "Buffer size" собственно и определяет объем буфера в мегабайтах. 
		Для трассировки соединеий достаточно установить величину в 2-3 MB.
		<P align="justify">
		Для начала захвата пакетов в буфер необходимо выбрать пункт Start в меню 
		Capture, или нажать соответствующую кнопку на панели инструментов. Немедленно 
		после этого ваш сетевой адаптер начнет захватывать все пакеты, приходящие на 
		ваш компьютер или исходящие с него. Одновременно с захватом 
		пакетов&nbsp;&nbsp;в правом верхнем окне отображаются данные статистики - 
		коэффициент загрузки сегмента, количество кадров в секунду и.т.д. Часть этих 
		данных отображается&nbsp;в левом верхнем окне в графическом виде. Ниже приведен 
		состав отображаемых утилитой стстистических величин:
		<P align="justify">В левом верхнем окне:
	<OL>
				<LI>
					<DIV align="justify">Network Utilization - коэффициент использования сети. 
						Показывает среднюю относительную загрузку сетевого соединения в процентах.</DIV>
				<LI>
					<DIV align="justify">
						Frames Per Second - число&nbsp;пакетов в секунду. Характеризует&nbsp;среднюю 
						частоту передачи и приема пакетов.</DIV>
				<LI>
					<DIV align="justify">Bytes Per Second - объем данных в секунду (в байтах). Этот 
						показатель определяет среднюю скорость обмена данными по сети.</DIV>
				<LI>
					<DIV align="justify">Broadcast Per Second - число широковещательных&nbsp;пакетов в 
						секунду. Так же, как и величина "Frames Per Second", указвает&nbsp;частоту 
						передачи и приема пакетов, однако подсчитывается только для широковещательных 
						сообщений.</DIV>
				<LI>
					<DIV align="justify">Multicast Per Second - число пакетов групповой рассылки в 
						секунду. Аналогична предыдущей величине с той разницей, что считается только 
						для пакетов групповой рассылки.</DIV>
				</LI>
	</OL>
		<P align="justify">В&nbsp;правом верхнем окне:</P>
		<P align="justify"><EM>Подгруппа Network Statistics:</EM></P>
		<OL>
			<LI>
				<DIV align="justify">Frames - количество переданных и принятых&nbsp;пакетов.</DIV>
			<LI>
				<DIV align="justify">Broadcasts -&nbsp; количество шировещательных пакетов.</DIV>
			<LI>
				<DIV align="justify">Multicasts-&nbsp; количество&nbsp;кадров пакетов групповой 
					рассылки.</DIV>
			<LI>
				<DIV align="justify">Bytes - объем переданных и принятых&nbsp;данных в байтах.</DIV>
			<LI>
				<DIV align="justify">Frames Dropped - количество потерянных пакетов.</DIV>
			<LI>
				<DIV align="justify">Network Status - состояние сетевого соединения.</DIV>
			</LI>
		</OL>
		<P align="justify"><EM>Подгруппа&nbsp;Captured Statistics:</EM></P>
		<OL>
			<LI>
			Frames - количество переданных и принятых&nbsp;пакетов.
			<LI>
			Frames in Buffer - количество&nbsp;перхваченных пакетов, сохранных во 
			внутреннем буфере утилиты.
			<LI>
			Frames lost when buffer exceeded - количество пакетов, не сохраненных из-за 
			переполнения буфера.
			<LI>
			Bytes - объем перехваченных данных в байтах.
			<LI>
			Bytes in Buffer -&nbsp;объем перехваченных данных, сохранных во внутреннем 
			буфере утилиты.
			<LI>
			Buffer Utilized - коэффициент заполнения буфера, выраженный в процентах.
			<LI>
				Frames Dropped - количество потерянных пакетов.</LI></OL>
		<P align="justify"><EM>Подгруппа&nbsp;Per Second&nbsp;Statistics:</EM></P>
		<OL>
			<LI>
				<DIV align="justify">Network Utilization - коэффициент использования сети. 
					Показывает среднюю относительную загрузку сетевого соединения в процентах.</DIV>
			<LI>
				<DIV align="justify">Frames Per Second - число&nbsp;пакетов в секунду. 
					Характеризует&nbsp;среднюю частоту передачи и приема пакетов.</DIV>
			<LI>
				<DIV align="justify">Bytes Per Second - объем данных в секунду (в байтах). Этот 
					показатель определяет среднюю скорость обмена данными по сети.</DIV>
			<LI>
				<DIV align="justify">Broadcast Per Second - число широковещательных&nbsp;пакетов в 
					секунду. Так же, как и величина "Frames Per Second", указвает&nbsp;частоту 
					передачи и приема пакетов, однако подсчитывается только для широковещательных 
					сообщений.</DIV>
			<LI>
				<DIV align="justify">Multicast Per Second - число пакетов групповой рассылки в 
					секунду. Аналогична предыдущей величине с той разницей, что считается только 
					для пакетов групповой рассылки.</DIV>
			</LI>
		</OL>
		<P align="justify"><EM>Подгруппа&nbsp;Network Card (MAC)&nbsp;Statistics:</EM></P>
		<OL>
			<LI>
			Frames - число&nbsp;пакетов, принятых физическим устройством доступа к сети.
			<LI>
			Broadcasts - число широковещательных&nbsp;пакетов, принятых физическим 
			устройством доступа к сети.
			<LI>
				<DIV align="justify">Multicasts - число пакетов групповой рассылки, принятых 
					физическим устройством доступа к сети.</DIV>
			<LI>
				<DIV align="justify">Bytes - объем данных, принятых физическим устройством доступа 
					к сети.</DIV>
			</LI>
		</OL>
		<P align="justify"><EM>Подгруппа&nbsp;Network Card (MAC)&nbsp;Error Statistics:</EM></P>
		<OL>
			<LI>
			CRC Errors&nbsp;- число&nbsp;ошибок, связянных с нарушением контрольной суммы 
			пакетов.
			<LI>
			Frames dropped (No Buffers)&nbsp;- число&nbsp;пакетов, потерянных из-за 
			недостаточного объема приемного буфера утилиты.
			<LI>
				<DIV align="justify">Frames dropped (Hardware)&nbsp;- число пакетов, потерянных 
					вследствие аппаратных ошибок.</DIV>
			</LI>
		</OL>
		<P align="justify">Примечание: не все сетевые карты поддерживают ведение 
			статистики, представленной последними двумя группами. Если данные о каких-либо 
			величинах этих групп не доступны, в соответствующем пункте окна статистики 
			появляются сообщения "Unsupported" или "UNKNOWN&nbsp;STAT".</P>
		<P align="justify">Для останова режима захвата кадров необходимовыбрать пункт Stop 
			and View в меню Capture . При этом на экране появится новое окно, в котором 
			будут показаны все пакеты, захваченные в буфер (рис. 2.4).
</P>
		<P align="center"><img src="Method.files/24.JPG" width="768" height="551"> </P>
		<P align="center">Рисунок 2.4. Сохраненные пакеты.</P>
		<P align="center">&nbsp;</P>
		<P align="justify">
		Каждый пакет отображается одной строкой, в котрой имеются адреса источника и 
		назначения кадра Ethernet, а также тип протокола самого верхнего уровня, 
		который вложен в этот кадр, например, SMB, LLC, FTP, DNS и т.п.
		<P align="justify">
		Каждый кадр можно отобразить более детально, щелкнув по нему два раза мышью. В 
		новом окне каждый вложенный в кадр пакет протокола отображается одной строкой, 
		и этот пакет можно также отобразить более детально аналогичным образом (рис. 2.5).
        <P align="center"><img src="Method.files/25.JPG" width="768" height="551">	
        <P align="center">Рисунок 2.5. Развернутая структура пакета. 
        <P align="justify">
		<P align="justify">Для более удобного рассмотрения сессии между двумя определенными компьютерами 
		можно наложить на захваченные кадры фильтр, который отсеивает на экране не 
		относящиеся к интересующей вас сессии кадры. Для этого в меню Display окна 
		нужно выбрать пункт Filter и в появивишейся панели два раза щелкнуть по условию 
		фильтрации ANY &lt;-&gt; ANY. В появившейся панели выбрать имена или адреса 
		интересующих вас компьютеров (рис. 2.6).
		<P align="center"><img src="Method.files/26.JPG" width="767" height="551"> 
        <P align="center">Рисунок 2.6. Окно установки фильтра. 
        <P align="left">
        <P align="left">Изначально фильтр настроен на отображение всех захваченных пакетов. Для того, чтобы NetMon отображал только интересующую вас информацию, например данные обмена между сервером и вашим компьютером, необходимо добавить соответствующий фильтр. Для этого необходимо нажать на кнопку &quot;Expression&quot; в правой верхней части окна и выбрать условия, по которым будет осуществляться фильтрация (рис. 2.7).
        <P align="center"><img src="Method.files/27.JPG" width="766" height="550"> 
        <P align="center">Рисунок 2.7. Окно выбора условий.
        <P align="justify">В этом окне можно выбрать условия для адресов, протоколов или свойств. Например, установим фильтр, отображающий только данные обмена между сервером и вашим компьютером. Для этого на одной из панелей (рис. 2.7) следует выбрать адрес LOCAL (192.168.0.1) а на другой - TITAN.VT (192.168.0.73). В окошке посередине можно выбирать направление обмена: &lt;--&gt; (в любую стоону) или --&gt; (от узла, выбранного в левой панели к узлу в правой). Если какие-либо адреса отсутствуют в списке, их можно добавить самостоятельно, нажав на кнопку &quot;Edit Addresses&quot; в правой нижней части окна. В результате в фильтр будет добавлено новое условие (рис. 2.8).
        <P align="center"><img src="Method.files/28.JPG" width="767" height="550"> 
        <P align="center">Рисунок 2.8
        <P align="justify">
        <P align="justify">Также с помощью фильтра можно отслеживать обмен только по заданному протоколу, например, FTP. Для этого необходимо нажать на кнопку &quot;Expression&quot; и в открывшемся окне перейти на вкладку &quot;Protocol&quot; (рис. 2.9).
        <P align="center"><img src="Method.files/29.JPG" width="768" height="551"> 
        <P align="center">Рисунок 2.9. Выбор протокола.                 
        <P align="justify">Изначально все протоколы разрешены. Нажмите кнопку &quot;Disable A<u>l</u>l&quot; для того, чтобы запретить все протоколы (при этом все протоколы переместятся из левого списка в правый), а затем выберите в списке запрещенных протоколов интересующий вас (например, FTP), и нажмите кнопку &quot;<u>E</u>nable&quot;. При этом выбранный протокол переместится в список доступных. Кроме выбранного вами протокола в список могут попадать прочие пункты, связанные с этим протоколом. Например, при выборе FTP в список автоматически добавляется протокол ATMMAPS. После применения фильтра NetMon будет отображать только те пакеты, которые передают данные FTP протокола (рис. 2.10).
        <P align="center"><img src="Method.files/210.JPG" width="768" height="551"> 
        <P align="center">Рисунок 2.10                 
        <P align="justify">&nbsp;</P>
        <P align="justify">Захваченные пакеты можно сохранить в файле для дальнейшего 
			анализа с помощью меню File и пункта Save. Создается файл с расширением .cap, 
			который впоследствии можно прочитать с помощью пункта Open.</P>
        <P align="justify">&nbsp;</P>
	</BODY>
</HTML>
